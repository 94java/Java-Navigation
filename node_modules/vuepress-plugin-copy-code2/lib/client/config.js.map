{"version":3,"file":"config.js","sources":["../../src/client/define.ts","../../src/client/utils/copy.ts","../../src/client/utils/icons.ts","../../src/client/composables/setup.ts","../../src/client/config.ts"],"sourcesContent":["import type { CopyCodeLocaleConfig } from \"../shared/index.js\";\n\ndeclare const COPY_CODE_DELAY: number;\ndeclare const COPY_CODE_DURATION: number;\ndeclare const COPY_CODE_LOCALES: CopyCodeLocaleConfig;\ndeclare const COPY_CODE_PURE: boolean;\ndeclare const COPY_CODE_SELECTOR: string | string[];\ndeclare const COPY_CODE_SHOW_IN_MOBILE: boolean;\n\nexport const copyCodeDelay = COPY_CODE_DELAY;\nexport const copyCodeDuration = COPY_CODE_DURATION;\nexport const copyCodeLocales = COPY_CODE_LOCALES;\nexport const copyCodePure = COPY_CODE_PURE;\nexport const copyCodeSelector = COPY_CODE_SELECTOR;\nexport const copyCodeShowInMobile = COPY_CODE_SHOW_IN_MOBILE;\n","export const copyToClipboard = async (text: string): Promise<void> => {\n  try {\n    return navigator.clipboard.writeText(text);\n  } catch {\n    const element = document.createElement(\"textarea\");\n    const previouslyFocusedElement = document.activeElement;\n\n    element.value = text;\n\n    // Prevent keyboard from showing on mobile\n    element.setAttribute(\"readonly\", \"\");\n\n    element.style.contain = \"strict\";\n    element.style.position = \"absolute\";\n    element.style.left = \"-9999px\";\n    element.style.fontSize = \"12pt\"; // Prevent zooming on iOS\n\n    const selection = document.getSelection();\n    const originalRange = selection\n      ? selection.rangeCount > 0 && selection.getRangeAt(0)\n      : null;\n\n    document.body.appendChild(element);\n    element.select();\n\n    // Explicit selection workaround for iOS\n    element.selectionStart = 0;\n    element.selectionEnd = text.length;\n\n    document.execCommand(\"copy\");\n    document.body.removeChild(element);\n\n    if (originalRange) {\n      selection!.removeAllRanges(); // originalRange canâ€™t be truthy when selection is falsy\n      selection!.addRange(originalRange);\n    }\n\n    // Get the focus back on the previously focused element, if any\n    if (previouslyFocusedElement) {\n      (previouslyFocusedElement as HTMLElement).focus();\n    }\n  }\n};\n","export const CHECK_ICON =\n  '<svg viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#06a35a\"><path d=\"M822.812 824.618c-83.076 81.992-188.546 124.614-316.05 127.865-122.085-3.251-223.943-45.873-305.935-127.865S76.213 640.406 72.962 518.682c3.251-127.503 45.873-232.973 127.865-316.05 81.992-83.075 184.211-126.058 305.936-129.309 127.503 3.251 232.973 46.234 316.049 129.31 83.076 83.076 126.059 188.546 129.31 316.05-2.89 121.723-46.234 223.943-129.31 305.935zM432.717 684.111c3.973 3.974 8.307 5.78 13.364 6.14 5.057.362 9.753-1.444 13.365-5.417l292.57-287.515c3.974-3.973 5.78-8.307 5.78-13.364s-1.806-9.753-5.78-13.365l1.807 1.806c-3.973-3.973-8.669-5.779-14.087-6.14-5.418-.361-10.475 1.445-14.809 5.418L460.529 592.006c-3.973 3.25-8.669 4.695-14.448 4.695-5.78 0-10.836-1.445-15.531-3.973l-94.273-72.962c-4.335-3.251-9.392-4.335-14.448-3.973s-9.392 3.25-12.642 7.585l-2.89 3.973c-3.25 4.334-4.334 9.391-3.973 14.81.722 5.417 2.528 10.113 5.779 14.086L432.717 684.11z\"/></svg>';\n","/**\n * Forked and edited from https://github.com/vxhly/vuepress-plugin-one-click-copy/blob/master/bin/clientRootMixin.js\n *\n * MIT License\n *\n * Copyright (c) 2019 vxhly <pengchengou@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * Â© 2019 GitHub, Inc.\n */\n\nimport { onMounted, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { Message, useLocaleConfig } from \"vuepress-shared/client\";\n\nimport {\n  copyCodeDelay,\n  copyCodeDuration,\n  copyCodeLocales,\n  copyCodePure,\n  copyCodeSelector,\n  copyCodeShowInMobile,\n} from \"../define.js\";\nimport { CHECK_ICON, copyToClipboard } from \"../utils/index.js\";\n\nimport \"vuepress-shared/client/styles/message.scss\";\n\nconst isMobile = (): boolean =>\n  navigator\n    ? /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/iu.test(\n        navigator.userAgent\n      )\n    : false;\n\nconst timeoutIdMap: Map<HTMLElement, NodeJS.Timeout> = new Map();\n\nexport const setupCopyCode = (): void => {\n  const route = useRoute();\n  const locale = useLocaleConfig(copyCodeLocales);\n\n  let message: Message;\n\n  const insertCopyButton = (codeBlockElement: HTMLElement): void => {\n    if (!codeBlockElement.hasAttribute(\"copy-code-registered\")) {\n      const copyElement = document.createElement(\"button\");\n\n      copyElement.classList.add(\"copy-code-button\");\n      copyElement.innerHTML = '<div class=\"copy-icon\" />';\n      copyElement.setAttribute(\"aria-label\", locale.value.copy);\n      copyElement.setAttribute(\"data-copied\", locale.value.copied);\n\n      if (copyCodePure) copyElement.classList.add(\"pure\");\n      else copyElement.setAttribute(\"data-balloon-pos\", \"left\");\n\n      if (codeBlockElement.parentElement)\n        codeBlockElement.parentElement.insertBefore(\n          copyElement,\n          codeBlockElement\n        );\n      codeBlockElement.setAttribute(\"copy-code-registered\", \"\");\n    }\n  };\n\n  const generateCopyButton = (): void => {\n    setTimeout(() => {\n      if (typeof copyCodeSelector === \"string\")\n        document\n          .querySelectorAll<HTMLElement>(copyCodeSelector)\n          .forEach(insertCopyButton);\n      else if (Array.isArray(copyCodeSelector))\n        copyCodeSelector.forEach((item) => {\n          document\n            .querySelectorAll<HTMLElement>(item)\n            .forEach(insertCopyButton);\n        });\n    }, copyCodeDelay || 500);\n  };\n\n  const copy = (\n    codeContainer: HTMLDivElement,\n    codeContent: HTMLPreElement,\n    button: HTMLButtonElement\n  ): void => {\n    let { innerText: text = \"\" } = codeContent;\n\n    if (\n      // is shell\n      /language-(shellscript|shell|bash|sh|zsh)/.test(\n        codeContainer.classList.toString()\n      )\n    )\n      text = text.replace(/^ *(\\$|>) /gm, \"\");\n\n    void copyToClipboard(text).then(() => {\n      button.classList.add(\"copied\");\n      clearTimeout(timeoutIdMap.get(button));\n\n      const timeoutId = setTimeout(() => {\n        button.classList.remove(\"copied\");\n        button.blur();\n        timeoutIdMap.delete(button);\n      }, 2000);\n\n      timeoutIdMap.set(button, timeoutId);\n\n      if (!copyCodePure)\n        message.pop(\n          `${CHECK_ICON}<span>${locale.value.hint} ðŸŽ‰</span>`,\n          copyCodeDuration\n        );\n    });\n  };\n\n  onMounted(() => {\n    message = new Message();\n\n    if (!isMobile() || copyCodeShowInMobile) generateCopyButton();\n\n    window.addEventListener(\"click\", (event) => {\n      const el = event.target as HTMLElement;\n\n      if (el.matches('div[class*=\"language-\"] > button.copy')) {\n        const codeContainer = <HTMLDivElement>el.parentElement;\n        const preBlock = <HTMLPreElement | null>el.nextElementSibling;\n\n        if (preBlock) copy(codeContainer, preBlock, <HTMLButtonElement>el);\n      } else if (el.matches('div[class*=\"language-\"] div.copy-icon')) {\n        const buttonElement = <HTMLButtonElement>el.parentElement;\n        const codeContainer = <HTMLDivElement>buttonElement.parentElement;\n        const preBlock = <HTMLPreElement | null>(\n          buttonElement.nextElementSibling\n        );\n\n        if (preBlock) copy(codeContainer, preBlock, buttonElement);\n      }\n    });\n  });\n\n  watch(\n    () => route.path,\n    () => {\n      if (!isMobile() || copyCodeShowInMobile) generateCopyButton();\n    }\n  );\n};\n","import { defineClientConfig } from \"@vuepress/client\";\nimport { setupCopyCode } from \"./composables/index.js\";\n\nimport \"balloon-css/balloon.css\";\nimport \"./styles/button.scss\";\n\nexport default defineClientConfig({\n  setup: () => {\n    setupCopyCode();\n  },\n});\n"],"names":["copyCodeDelay","copyCodeDuration","copyCodeLocales","copyCodePure","copyCodeSelector","copyCodeShowInMobile","copyToClipboard","text","element","previouslyFocusedElement","selection","originalRange","CHECK_ICON","isMobile","timeoutIdMap","setupCopyCode","route","useRoute","locale","useLocaleConfig","message","insertCopyButton","codeBlockElement","copyElement","generateCopyButton","item","copy","codeContainer","codeContent","button","timeoutId","onMounted","Message","event","el","preBlock","buttonElement","watch","defineClientConfig"],"mappings":"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"}