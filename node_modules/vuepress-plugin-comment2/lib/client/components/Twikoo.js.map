{"version":3,"file":"Twikoo.js","sources":["../../../src/client/components/Twikoo.ts"],"sourcesContent":["import { usePageFrontmatter, usePageLang } from \"@vuepress/client\";\nimport { computed, defineComponent, h, onMounted } from \"vue\";\n\nimport type { VNode } from \"vue\";\nimport type {\n  CommentPluginFrontmatter,\n  TwikooOptions,\n} from \"../../shared/index.js\";\n\nimport \"../styles/twikoo.scss\";\n\ndeclare const COMMENT_OPTIONS: TwikooOptions;\n\nconst twikooOption = COMMENT_OPTIONS;\nconst enableTwikoo = Boolean(twikooOption.envId);\n\nexport default defineComponent({\n  name: \"TwikooComment\",\n\n  setup() {\n    const frontmatter = usePageFrontmatter<CommentPluginFrontmatter>();\n    const lang = usePageLang();\n\n    let id: number;\n\n    const enableComment = computed(() => {\n      if (!enableTwikoo) return false;\n      const pluginConfig = twikooOption.comment !== false;\n      const pageConfig = frontmatter.value.comment;\n\n      return (\n        // Enable in page\n        Boolean(pageConfig) ||\n        // not disabled in anywhere\n        (pluginConfig !== false && pageConfig !== false)\n      );\n    });\n\n    const initTwikoo = (): void => {\n      const timeID = (id = new Date().getTime());\n\n      void Promise.all([\n        import(\"twikoo\"),\n        new Promise<void>((resolve) => setTimeout(resolve, twikooOption.delay)),\n      ]).then(([{ init }]) => {\n        if (timeID === id)\n          void init({\n            lang: lang.value === \"zh-CN\" ? \"zh-CN\" : \"en\",\n            ...twikooOption,\n            el: \"#twikoo-comment\",\n          });\n      });\n    };\n\n    onMounted(() => {\n      if (enableTwikoo) initTwikoo();\n    });\n\n    return (): VNode =>\n      h(\n        \"div\",\n        {\n          class: \"twikoo-wrapper\",\n          style: { display: enableComment.value ? \"block\" : \"none\" },\n        },\n        h(\"div\", { id: \"twikoo-comment\" })\n      );\n  },\n});\n"],"names":["twikooOption","enableTwikoo","defineComponent","frontmatter","usePageFrontmatter","lang","usePageLang","id","enableComment","computed","pluginConfig","pageConfig","initTwikoo","timeID","resolve","init","onMounted","h"],"mappings":"+KAaA,MAAMA,EAAe,gBACfC,EAAe,QAAQD,EAAa,KAAK,EAE/C,IAAeE,EAAAA,EAAgB,CAC7B,KAAM,gBAEN,OAAQ,CACN,MAAMC,EAAcC,EAAAA,EACdC,EAAOC,IAEb,IAAIC,EAEJ,MAAMC,EAAgBC,EAAS,IAAM,CACnC,GAAI,CAACR,EAAc,MAAO,GAC1B,MAAMS,EAAeV,EAAa,UAAY,GACxCW,EAAaR,EAAY,MAAM,QAErC,OAEE,QAAQQ,CAAU,GAEjBD,IAAiB,IAASC,IAAe,EAE9C,CAAC,EAEKC,EAAa,IAAY,CAC7B,MAAMC,EAAUN,EAAK,IAAI,KAAK,EAAE,QAAQ,EAEnC,QAAQ,IAAI,CACf,OAAO,UACP,IAAI,QAAeO,GAAY,WAAWA,EAASd,EAAa,KAAK,CAAC,CACxE,CAAC,EAAE,KAAK,CAAC,CAAC,CAAE,KAAAe,CAAK,CAAC,IAAM,CAClBF,IAAWN,GACRQ,EAAK,CACR,KAAMV,EAAK,QAAU,QAAU,QAAU,KACzC,GAAGL,EACH,GAAI,iBACN,CAAC,CACL,CAAC,CACH,EAEA,OAAAgB,EAAU,IAAM,CACVf,GAAcW,EAAAA,CACpB,CAAC,EAEM,IACLK,EACE,MACA,CACE,MAAO,iBACP,MAAO,CAAE,QAAST,EAAc,MAAQ,QAAU,MAAO,CAC3D,EACAS,EAAE,MAAO,CAAE,GAAI,gBAAiB,CAAC,CACnC,CACJ,CACF,CAAC"}