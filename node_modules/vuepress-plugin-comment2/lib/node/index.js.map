{"version":3,"file":"index.js","sources":["../../src/node/locales.ts","../../src/node/compact.ts","../../src/node/utils.ts","../../src/node/plugin.ts"],"sourcesContent":["import type { WalineLocaleConfig } from \"../shared/index.js\";\n\n/**\n * Default locale config for Waline\n */\nexport const walineLocales: WalineLocaleConfig = {\n  \"/en/\": {\n    placeholder:\n      \"Write a comment here (Fill in the email address to receive an email notification when being replied)\",\n  },\n\n  \"/zh/\": {\n    placeholder: \"请留言。(填写邮箱可在被回复时收到邮件提醒)\",\n  },\n\n  \"/zh-tw/\": {\n    placeholder: \"請留言。(填寫信箱可在被回覆時收到郵件提醒)\",\n  },\n\n  \"/de-at/\": {\n    placeholder:\n      \"Schreibe ein Kommentar (Geben Sie die E-Mail-Adresse ein, um eine E-Mail-Benachrichtigung zu erhalten, wenn Sie geantwortet werden)\",\n  },\n\n  \"/vi/\": {\n    placeholder:\n      \"Để lại bình luận (Điền địa chỉ email để nhận email thông báo khi được trả lời)\",\n  },\n\n  \"/uk/\": {\n    placeholder:\n      \"Напишіть тут коментар (введіть адресу електронної пошти, щоб отримувати сповіщення електронною поштою, коли буде відповідь)\",\n  },\n\n  \"/ru/\": {\n    placeholder:\n      \"Напишите комментарий здесь (Введите адрес электронной почты, чтобы получить уведомление по электронной почте при ответе)\",\n  },\n\n  \"/br/\": {\n    placeholder:\n      \"Escreva um comentário aqui (preencha com o endereço de email para receber notificações quando tiver alguma resposta)\",\n  },\n\n  \"/pl/\": {\n    placeholder:\n      \"Wpisz tutaj komentarz (wpisz adres e-mail, aby otrzymać powiadomienie e-mail, gdy otrzymasz odpowiedź)\",\n  },\n\n  \"/sk/\": {\n    placeholder:\n      \"Napíš svoj komentár (vlož svoj e-mail taktiež, aby si bol notifikovaný o odpovediach)\",\n  },\n\n  \"/fr/\": {\n    placeholder:\n      \"Écrivez votre commentaire ici (Inscrivez votre email afin de recevoir une notification en cas de réponse)\",\n  },\n\n  \"/es/\": {\n    placeholder:\n      \"Escriba un comentario aquí (Ingrese su correo electrónico para recibir una notificación en caso de respuesta)\",\n  },\n\n  \"/ja/\": {\n    placeholder:\n      \"伝言をどうぞ (メールアドレスを入力すると、返信があった際にメールでお知らせします。)\",\n  },\n\n  \"/tr/\": {\n    placeholder:\n      \"Buraya bir yorum yazın (Yanıtlandığında bir e-posta bildirimi almak için e-posta adresinizi girin)\",\n  },\n\n  \"/ko/\": {\n    placeholder:\n      \"댓글을 남겨주세요 (답변이 있을 경우 이메일로 알림을 받으려면 이메일 주소를 입력하세요)\",\n  },\n};\n","import type { CommentOptions } from \"../shared/index.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: CommentOptions & Record<string, unknown>\n): void => {\n  if (\"type\" in options) {\n    console.warn(`\"type\" is deprecated, please use \"provider\".`);\n    if (options[\"type\"] === \"waline\") options.provider = \"Waline\";\n    else if (options[\"type\"] === \"giscus\") options.provider = \"Giscus\";\n    else if (options[\"type\"] === \"twikoo\") options.provider = \"Twikoo\";\n\n    delete options[\"type\"];\n  }\n\n  // convert Waline options\n  if (options.provider === \"Waline\") {\n    [\n      // valine\n      [\"emojiCDN\", \"emoji\"],\n      [\"emojiMaps\", \"emoji\"],\n      [\"requiredFields\", \"requiredMeta\"],\n      [\"visitor\", \"pageview\"],\n      [\"langMode\", \"locale\"],\n      [\"placeholder\", \"locale.placeholder\"],\n\n      // waline v1\n      [\"anonymous\", \"login\"],\n      [\"copyRight\", \"copyright\"],\n    ].forEach(([oldOptions, newOptions]) => {\n      if (oldOptions in options) {\n        console.warn(\n          `\"${oldOptions}\" is deprecated in @waline/client@v2, you should use \"${newOptions}\" instead.`\n        );\n\n        // @ts-ignore\n        delete options[oldOptions];\n      }\n    });\n\n    [\n      // valine\n      \"region\",\n      \"appId\",\n      \"appKey\",\n      \"notify\",\n      \"verify\",\n      \"avatar\",\n      \"avatarForce\",\n      \"enableQQ\",\n      \"recordIP\",\n      \"serverURLs\",\n\n      // waline v1\n      \"avatarCDN\",\n      \"mathTagSupport\",\n      \"highlight\",\n      \"uploadImage\",\n      \"previewMath\",\n    ].forEach((option) => {\n      if (option in options) {\n        console.warn(\n          `\"${option}\" is no longer supported in @waline/client@v2.`\n        );\n\n        // @ts-ignore\n        delete options[option];\n      }\n    });\n  }\n};\n","import { Logger } from \"vuepress-shared/node\";\n\nexport const logger = new Logger(\"vuepress-plugin-comment2\");\n","import { getDirname, path } from \"@vuepress/utils\";\nimport { useSassPalettePlugin } from \"vuepress-plugin-sass-palette\";\nimport {\n  addCustomElement,\n  addViteSsrExternal,\n  addViteOptimizeDepsExclude,\n  addViteOptimizeDepsInclude,\n  getLocales,\n  noopModule,\n} from \"vuepress-shared/node\";\n\nimport { convertOptions } from \"./compact.js\";\nimport { walineLocales } from \"./locales.js\";\nimport { logger } from \"./utils.js\";\n\nimport type { CommentOptions } from \"../shared/index.js\";\nimport type { PluginFunction } from \"@vuepress/core\";\n\nconst __dirname = getDirname(import.meta.url);\n\n/** Comment Plugin */\nexport const commentPlugin =\n  (options: CommentOptions, legacy = false): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy)\n      convertOptions(options as CommentOptions & Record<string, unknown>);\n    if (app.env.isDebug) logger.info(`Options: ${options.toString()}`);\n\n    const provider =\n      options.provider &&\n      [\"Giscus\", \"Waline\", \"Twikoo\"].includes(options.provider)\n        ? options.provider\n        : \"None\";\n\n    const userWalineLocales =\n      options.provider === \"Waline\"\n        ? getLocales({\n            app,\n            name: \"waline\",\n            default: walineLocales,\n            config: options.walineLocales,\n          })\n        : {};\n\n    // remove locales so that they won’t be injected in client twice\n    if (\"walineLocales\" in options) delete options.walineLocales;\n\n    useSassPalettePlugin(app, { id: \"hope\" });\n\n    return {\n      name: \"vuepress-plugin-comment2\",\n\n      alias: {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        \"vuepress-plugin-comment2/provider\":\n          provider === \"None\"\n            ? noopModule\n            : path.resolve(__dirname, `../client/components/${provider}.js`),\n      },\n\n      define: () => ({\n        COMMENT_OPTIONS: options,\n        ...(options.provider === \"Waline\"\n          ? {\n              WALINE_LOCALES: userWalineLocales,\n              WALINE_META: options.metaIcon !== false,\n            }\n          : {}),\n      }),\n\n      extendsBundlerOptions: (config: unknown, app): void => {\n        if (provider === \"Giscus\") {\n          addCustomElement({ app, config }, \"GiscusWidget\");\n          addViteSsrExternal({ app, config }, \"giscus\");\n        }\n\n        if (provider === \"Waline\") {\n          addViteOptimizeDepsInclude({ app, config }, \"autosize\");\n          addViteOptimizeDepsExclude({ app, config }, \"@waline/client\");\n          addViteSsrExternal({ app, config }, \"@waline/client\");\n        }\n\n        if (provider === \"Twikoo\") {\n          addViteOptimizeDepsInclude({ app, config }, \"twikoo\");\n          addViteSsrExternal({ app, config }, \"twikoo\");\n        }\n      },\n\n      clientConfigFile: path.resolve(__dirname, \"../client/config.js\"),\n    };\n  };\n"],"names":["walineLocales","convertOptions","options","oldOptions","newOptions","option","logger","Logger","__dirname","getDirname","commentPlugin","legacy","app","provider","userWalineLocales","getLocales","useSassPalettePlugin","noopModule","path","config","addCustomElement","addViteSsrExternal","addViteOptimizeDepsInclude","addViteOptimizeDepsExclude"],"mappings":"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"}