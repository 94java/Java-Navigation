import { fs, getDirname, path } from "@vuepress/utils";
import { logger } from "../utils.js";
const __dirname = getDirname(import.meta.url);
export const checkSocialMediaIcons = (themeData) => {
    const icons = {};
    const checkIcon = (key, value) => {
        if (typeof value === "string") {
            const templatePath = path.resolve(__dirname, `../../../templates/socialMediaIcons/${key.toLocaleLowerCase()}.svg`);
            if (fs.existsSync(templatePath)) {
                icons[key] = fs.readFileSync(templatePath, { encoding: "utf-8" });
                return value;
            }
            logger.warn(`${key} icon in blog media config not found!`);
            return false;
        }
        if (Array.isArray(value)) {
            // it’s a svg string
            if (value[1].startsWith("<svg")) {
                icons[key] = value[1];
                return value[0];
            }
            // it’s probably a path
            if (fs.existsSync(value[1])) {
                icons[key] = fs.readFileSync(value[1], { encoding: "utf-8" });
                return value[0];
            }
            logger.warn(`${key}'s icon ${value[1]} in blog media config is invalid!`);
            return false;
        }
        logger.warn(`${key} icon in blog media config has an invalid config!`);
        return false;
    };
    Object.entries(themeData.blog?.medias || {}).forEach(([key, value]) => {
        const result = checkIcon(key, value);
        if (result)
            themeData.blog.medias[key] = result;
        else
            delete themeData.blog.medias[key];
    });
    if (themeData.locales)
        Object.entries(themeData.locales).forEach(([, localeConfig]) => {
            Object.entries(localeConfig.blog?.medias || {}).forEach(([key, value]) => {
                const result = checkIcon(key, value);
                if (result)
                    localeConfig.blog.medias[key] = result;
                else
                    delete localeConfig.blog.medias[key];
            });
        });
    return icons;
};
//# sourceMappingURL=socialMedia.js.map