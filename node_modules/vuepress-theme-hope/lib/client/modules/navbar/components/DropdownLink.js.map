{"version":3,"file":"DropdownLink.js","sourceRoot":"","sources":["../../../../../src/client/modules/navbar/components/DropdownLink.ts"],"names":[],"mappings":"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","sourcesContent":["import { computed, defineComponent, h, ref, toRef, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nimport AutoLink from \"@theme-hope/components/AutoLink.js\";\nimport Icon from \"@theme-hope/components/Icon.js\";\n\nimport type { PropType, VNode } from \"vue\";\nimport type {\n  AutoLinkOptions as AutoLinkType,\n  NavGroup,\n} from \"../../../../shared/index.js\";\n\nimport \"../styles/dropdown-link.scss\";\n\nexport default defineComponent({\n  name: \"NavbarDropdownLink\",\n\n  props: {\n    /**\n     * Dropdown config\n     *\n     * 下拉列表配置\n     */\n    config: {\n      type: Object as PropType<NavGroup<AutoLinkType | NavGroup<AutoLinkType>>>,\n      required: true,\n    },\n  },\n\n  setup(props, { slots }) {\n    const route = useRoute();\n    const config = toRef(props, \"config\");\n\n    const dropdownAriaLabel = computed(\n      () => config.value.ariaLabel || config.value.text\n    );\n\n    const open = ref(false);\n\n    watch(\n      () => route.path,\n      () => {\n        open.value = false;\n      }\n    );\n\n    /**\n     * Open the dropdown when user tab and click from keyboard.\n     *\n     * Use event.detail to detect tab and click from keyboard.\n     * The Tab + Click is UIEvent > KeyboardEvent, so the detail is 0.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/UIEvent/detail\n     */\n    const handleDropdown = (event: MouseEvent): void => {\n      const isTriggerByTab = event.detail === 0;\n\n      if (isTriggerByTab) open.value = !open.value;\n    };\n\n    return (): VNode =>\n      h(\"div\", { class: [\"dropdown-wrapper\", { open: open.value }] }, [\n        h(\n          \"button\",\n          {\n            class: \"dropdown-title\",\n            type: \"button\",\n            \"aria-label\": dropdownAriaLabel.value,\n            onClick: handleDropdown,\n          },\n          [\n            slots[\"title\"]?.() ||\n              h(\"span\", { class: \"title\" }, [\n                h(Icon, { icon: config.value.icon }),\n                props.config.text,\n              ]),\n            h(\"span\", { class: \"arrow\" }),\n            h(\n              \"ul\",\n              { class: \"nav-dropdown\" },\n              config.value.children.map((child, index) => {\n                const isLastChild = index === config.value.children.length - 1;\n\n                return h(\n                  \"li\",\n                  { class: \"dropdown-item\" },\n                  \"children\" in child\n                    ? [\n                        h(\n                          \"h4\",\n                          { class: \"dropdown-subtitle\" },\n                          child.link\n                            ? h(AutoLink, {\n                                config: child as AutoLinkType,\n                                onFocusout: () => {\n                                  if (\n                                    // no children\n                                    child.children.length === 0 &&\n                                    isLastChild\n                                  )\n                                    open.value = false;\n                                },\n                              })\n                            : h(\"span\", child.text)\n                        ),\n                        h(\n                          \"ul\",\n                          { class: \"dropdown-subitem-wrapper\" },\n                          child.children.map((grandchild, grandIndex) =>\n                            h(\n                              \"li\",\n                              { class: \"dropdown-subitem\" },\n                              h(AutoLink, {\n                                config: grandchild,\n                                onFocusout: () => {\n                                  if (\n                                    // last item of grandchild\n                                    grandIndex === child.children.length - 1 &&\n                                    isLastChild\n                                  )\n                                    open.value = false;\n                                },\n                              })\n                            )\n                          )\n                        ),\n                      ]\n                    : h(AutoLink, {\n                        config: child,\n                        onFocusout: () => {\n                          if (isLastChild) open.value = false;\n                        },\n                      })\n                );\n              })\n            ),\n          ]\n        ),\n      ]);\n  },\n});\n"]}