{"version":3,"file":"PageViewInfo.js","sourceRoot":"","sources":["../../../../../src/client/modules/info/components/PageViewInfo.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,kBAAkB,CAAC;AAC5C,OAAO,EAAE,eAAe,EAAE,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,KAAK,CAAC;AAChE,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAEtC,OAAO,EACL,OAAO,EACP,QAAQ,GACT,MAAM,8CAA8C,CAAC;AACtD,OAAO,EAAE,aAAa,EAAE,MAAM,+CAA+C,CAAC;AAI9E,eAAe,eAAe,CAAC;IAC7B,IAAI,EAAE,cAAc;IAEpB,YAAY,EAAE,KAAK;IAEnB,KAAK,EAAE;QACL;;;;WAIG;QACH,QAAQ,EAAE;YACR,IAAI,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC;YACvB,OAAO,EAAE,KAAK;SACf;QAED;;;;WAIG;QACH,IAAI,EAAE,OAAO;KACd;IAED,KAAK,CAAC,KAAK;QACT,MAAM,KAAK,GAAG,QAAQ,EAAE,CAAC;QACzB,MAAM,UAAU,GAAG,aAAa,EAAE,CAAC;QAEnC,MAAM,SAAS,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QAEzB,+CAA+C;QAC/C,MAAM,QAAQ,GAAG,GAAS,EAAE;YAC1B,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,wBAAwB,CAAC,CAAC;YAEtE,IAAI,YAAY,EAAE;gBAChB,MAAM,KAAK,GAAG,YAAY,CAAC,WAAW,CAAC;gBAEvC,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;oBAAE,SAAS,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;;oBAC/D,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;aAChC;QACH,CAAC,CAAC;QAEF,SAAS,CAAC,GAAG,EAAE;YACb,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;QAEH,KAAK,CACH,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,EAChB,CAAC,QAAgB,EAAE,QAAgB,EAAE,EAAE;YACrC,IAAI,QAAQ,KAAK,QAAQ;gBAAE,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QACvD,CAAC,CACF,CAAC;QAEF,OAAO,GAAiB,EAAE,CACxB,KAAK,CAAC,QAAQ;YACZ,CAAC,CAAC,CAAC,CACC,MAAM,EACN;gBACE,KAAK,EAAE,cAAc;gBACrB,YAAY,EAAE,GAAG,UAAU,CAAC,KAAK,CAAC,KAAK,GACrC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IACpB,EAAE;gBACF,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,kBAAkB,EAAE,MAAM,EAAE,CAAC;aACtD,EACD;gBACE,CAAC,CAAC,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC;gBAC9C,CAAC,CACC,MAAM,EACN;oBACE,KAAK,EAAE,uBAAuB;oBAC9B,gBAAgB;oBAChB,WAAW,EACT,OAAO,KAAK,CAAC,QAAQ,KAAK,QAAQ;wBAChC,CAAC,CAAC,KAAK,CAAC,QAAQ;wBAChB,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC;iBAC3B,EACD,KAAK,CACN;aACF,CACF;YACH,CAAC,CAAC,IAAI,CAAC;IACb,CAAC;CACF,CAAC,CAAC","sourcesContent":["import { withBase } from \"@vuepress/client\";\nimport { defineComponent, h, onMounted, watch, ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nimport {\n  EyeIcon,\n  FireIcon,\n} from \"@theme-hope/modules/info/components/icons.js\";\nimport { useMetaLocale } from \"@theme-hope/modules/info/composables/index.js\";\n\nimport type { VNode } from \"vue\";\n\nexport default defineComponent({\n  name: \"PageViewInfo\",\n\n  inheritAttrs: false,\n\n  props: {\n    /**\n     * Whether show pageview and it's path\n     *\n     * 是否显示浏览量以及其路径\n     */\n    pageview: {\n      type: [Boolean, String],\n      default: false,\n    },\n\n    /**\n     * Whether in pure mode\n     *\n     * 是否处于纯净模式\n     */\n    pure: Boolean,\n  },\n\n  setup(props) {\n    const route = useRoute();\n    const metaLocale = useMetaLocale();\n\n    const pageViews = ref(0);\n\n    // show fire icon depending on the views number\n    const getCount = (): void => {\n      const countElement = document.querySelector(\".waline-pageview-count\");\n\n      if (countElement) {\n        const count = countElement.textContent;\n\n        if (count && !isNaN(Number(count))) pageViews.value = Number(count);\n        else setTimeout(getCount, 500);\n      }\n    };\n\n    onMounted(() => {\n      setTimeout(getCount, 1500);\n    });\n\n    watch(\n      () => route.path,\n      (newValue: string, oldValue: string) => {\n        if (newValue !== oldValue) setTimeout(getCount, 500);\n      }\n    );\n\n    return (): VNode | null =>\n      props.pageview\n        ? h(\n            \"span\",\n            {\n              class: \"visitor-info\",\n              \"aria-label\": `${metaLocale.value.views}${\n                props.pure ? \"\" : \"🔢\"\n              }`,\n              ...(props.pure ? {} : { \"data-balloon-pos\": \"down\" }),\n            },\n            [\n              h(pageViews.value < 1000 ? EyeIcon : FireIcon),\n              h(\n                \"span\",\n                {\n                  class: \"waline-pageview-count\",\n                  /** visitorID */\n                  \"data-path\":\n                    typeof props.pageview === \"string\"\n                      ? props.pageview\n                      : withBase(route.path),\n                },\n                \"...\"\n              ),\n            ]\n          )\n        : null;\n  },\n});\n"]}