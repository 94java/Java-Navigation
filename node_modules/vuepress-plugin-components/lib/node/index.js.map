{"version":3,"file":"index.js","sources":["../../src/node/locales.ts","../../src/node/utils.ts","../../src/node/prepare.ts","../../src/node/plugins.ts"],"sourcesContent":["import type { BackToTopLocaleConfig } from \"../shared/index.js\";\n\nexport const backToTopLocales: BackToTopLocaleConfig = {\n  \"/en/\": {\n    backToTop: \"Back to top\",\n  },\n\n  \"/zh/\": {\n    backToTop: \"返回顶部\",\n  },\n\n  \"/zh-tw/\": {\n    backToTop: \"返回頂部\",\n  },\n\n  \"/de-at/\": {\n    backToTop: \"Zurück nach oben.\",\n  },\n\n  \"/vi/\": {\n    backToTop: \"Trở lại đầu trang\",\n  },\n\n  \"/uk/\": {\n    backToTop: \"Повернутися до початку\",\n  },\n\n  \"/ru/\": {\n    backToTop: \"Вернуться к началу\",\n  },\n\n  \"/br/\": {\n    backToTop: \"Volta ao topo\",\n  },\n\n  \"/pl/\": {\n    backToTop: \"Wróć na górę\",\n  },\n\n  \"/sk/\": {\n    backToTop: \"Back to top\",\n  },\n\n  \"/fr/\": {\n    backToTop: \"Back to top\",\n  },\n\n  \"/es/\": {\n    backToTop: \"Volver arriba\",\n  },\n\n  \"/ja/\": {\n    backToTop: \"このページのトップへ戻る\",\n  },\n\n  \"/tr/\": {\n    backToTop: \"En başa dön\",\n  },\n\n  \"/ko/\": {\n    backToTop: \"맨 위로\",\n  },\n};\n","import { Logger } from \"vuepress-shared/node\";\n\nexport const logger = new Logger(\"vuepress-plugin-components\");\n\nexport const getIconPrefix = (iconAssetsLink = \"\"): string => {\n  if (\n    iconAssetsLink === \"fontawesome\" ||\n    iconAssetsLink.match(/^(?:https:)?\\/\\/kit\\.fontawesome\\.com\\//)\n  )\n    return \"fas fa-\";\n  if (\n    iconAssetsLink === \"iconfont\" ||\n    iconAssetsLink.match(/^(?:https:)?\\/\\/at\\.alicdn\\.com\\/t\\//)\n  )\n    return \"iconfont icon-\";\n\n  return \"\";\n};\n","import { ensureEndingSlash } from \"@vuepress/shared\";\nimport { getDirname, path } from \"@vuepress/utils\";\nimport { logger } from \"./utils.js\";\n\nimport type { App } from \"@vuepress/core\";\nimport type { AvailableComponent, ComponentOptions } from \"./options.js\";\n\nconst __dirname = getDirname(import.meta.url);\nconst CLIENT_FOLDER = ensureEndingSlash(path.resolve(__dirname, \"../client\"));\n\nconst availableComponents: AvailableComponent[] = [\n  \"Badge\",\n  \"BiliBili\",\n  \"CodePen\",\n  \"FontIcon\",\n  \"PDF\",\n  \"StackBlitz\",\n  \"VideoPlayer\",\n  \"YouTube\",\n];\n\nconst getIconLink = (\n  iconLink: string\n): { type: string; content: string } | null => {\n  if (iconLink === \"fontawesome\")\n    return {\n      type: \"script\",\n      content: \"https://kit.fontawesome.com/ca37c296c5.js\",\n    };\n\n  if (iconLink === \"iconfont\")\n    return {\n      type: \"style\",\n      content: `@import url(\"//at.alicdn.com/t/font_2410206_a0xb9hku9iu.css\");`,\n    };\n\n  const actualLink = iconLink.match(/^(?:https?:)?\\/\\//g)\n    ? iconLink\n    : `//${iconLink}`;\n\n  if (actualLink.endsWith(\".css\"))\n    return {\n      type: \"style\",\n      content: `@import url(\"${iconLink}\");`,\n    };\n\n  if (actualLink.endsWith(\".js\"))\n    return {\n      type: \"script\",\n      content: iconLink,\n    };\n\n  logger.error(`Can not recognize icon link: \"${iconLink}\"`);\n\n  return null;\n};\n\nexport const prepareConfigFile = (\n  app: App,\n  options: ComponentOptions\n): Promise<string> => {\n  let configImport = \"\";\n  let enhance = \"\";\n  let setup = \"\";\n  let rootComponents = \"\";\n  let shouldImportH = false;\n  let shouldImportUseScriptTag = false;\n  let shouldImportUseStyleTag = false;\n\n  options.components.forEach((item) => {\n    if (availableComponents.includes(item)) {\n      configImport += `\\\nimport ${item} from \"${CLIENT_FOLDER}components/${item}.js\";\n`;\n      enhance += `\\\napp.component(\"${item}\", ${item});\n`;\n    }\n\n    if (item === \"FontIcon\" && options.iconAssets) {\n      const result = getIconLink(options.iconAssets);\n\n      if (result) {\n        const { type, content } = result;\n\n        if (type === \"script\") {\n          shouldImportUseScriptTag = true;\n          setup += `\\\nuseScriptTag(\\`${content}\\`);\n`;\n        } else {\n          shouldImportUseStyleTag = true;\n          setup += `\\\nuseStyleTag(\\`${content}\\`, { id: \"icon-assets\" });\n`;\n        }\n      }\n    }\n  });\n\n  if (typeof options.addThis === \"string\") {\n    shouldImportUseScriptTag = true;\n    setup += `\\\nuseScriptTag(\\`//s7.addthis.com/js/300/addthis_widget.js#pubid=${options.addThis}\\`);\n`;\n  }\n\n  if (options.backToTop) {\n    shouldImportH = true;\n    configImport += `\\\nimport BackToTop from \"${CLIENT_FOLDER}components/BackToTop.js\";\n`;\n    rootComponents += `\\\n() => h(BackToTop, { threshold: ${\n      typeof options.backToTop === \"number\" ? options.backToTop : 300\n    } }),\n`;\n  }\n\n  if (options.notice) {\n    shouldImportH = true;\n    configImport += `\\\nimport Notice from \"${CLIENT_FOLDER}components/Notice.js\";\n`;\n\n    rootComponents += `\\\n() => h(Notice, ${JSON.stringify(options.notice)}),\n`;\n  }\n\n  return app.writeTemp(\n    `components/config.js`,\n    `\\\nimport { defineClientConfig } from \"@vuepress/client\";\n${\n  shouldImportH\n    ? `\\\nimport { h } from \"vue\";\n`\n    : \"\"\n}\n${\n  shouldImportUseScriptTag\n    ? `\\\nimport { useScriptTag } from \"${CLIENT_FOLDER}vueuse.js\";\n`\n    : \"\"\n}\\\n${\n  shouldImportUseStyleTag\n    ? `\\\nimport { useStyleTag } from \"${CLIENT_FOLDER}vueuse.js\";\n`\n    : \"\"\n}\\\n${configImport}\n\nimport \"${CLIENT_FOLDER}styles/sr-only.scss\";\n\nexport default defineClientConfig({\n  enhance: ({ app }) => {\n${enhance\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  },\n  setup: () => {\n${setup\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  },\n  rootComponents: [\n${rootComponents\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  ],\n});\n`\n  );\n};\n","import { useSassPalettePlugin } from \"vuepress-plugin-sass-palette\";\nimport { getLocales } from \"vuepress-shared/node\";\n\nimport { backToTopLocales } from \"./locales.js\";\nimport { prepareConfigFile } from \"./prepare.js\";\nimport { getIconPrefix, logger } from \"./utils.js\";\n\nimport type { PluginFunction } from \"@vuepress/core\";\nimport type { ComponentOptions } from \"./options.js\";\n\nexport const componentsPlugin =\n  (options: ComponentOptions): PluginFunction =>\n  (app) => {\n    if (app.env.isDebug) logger.info(`Options: ${options.toString()}`);\n\n    useSassPalettePlugin(app, { id: \"hope\" });\n\n    return {\n      name: \"vuepress-plugin-components\",\n\n      define: {\n        BACK_TO_TOP_LOCALES: getLocales({\n          app,\n          name: \"backToTop\",\n          default: backToTopLocales,\n          config: options.backToTopLocales,\n        }),\n        ICON_PREFIX:\n          typeof options.iconPrefix === \"string\"\n            ? options.iconPrefix\n            : getIconPrefix(options.iconAssets),\n      },\n\n      clientConfigFile: (app) => prepareConfigFile(app, options),\n    };\n  };\n"],"names":["backToTopLocales","logger","Logger","getIconPrefix","iconAssetsLink","__dirname","getDirname","CLIENT_FOLDER","ensureEndingSlash","path","availableComponents","getIconLink","iconLink","actualLink","prepareConfigFile","app","options","configImport","enhance","setup","rootComponents","shouldImportH","shouldImportUseScriptTag","shouldImportUseStyleTag","item","result","type","content","componentsPlugin","useSassPalettePlugin","getLocales"],"mappings":"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"}