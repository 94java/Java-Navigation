{"version":3,"file":"index.js","sources":["../../src/client/composables/useBlogCategory.ts","../../src/client/composables/useBlogType.ts"],"sourcesContent":["import { categoryMap } from \"@temp/blog/category\";\nimport { usePageFrontmatter, useRouteLocale } from \"@vuepress/client\";\nimport { computed, ref } from \"vue\";\nimport { useRouter, useRoute } from \"vue-router\";\nimport { resolveRouteWithRedirect } from \"vuepress-shared/client\";\n\nimport type { ComputedRef } from \"vue\";\nimport type {\n  BlogCategoryFrontmatterOptions,\n  CategoryMap,\n} from \"../../shared/index.js\";\nimport type { BlogCategoryData } from \"../typings.js\";\n\n// eslint-disable-next-line\ndeclare const __VUE_HMR_RUNTIME__: Record<string, any>;\ndeclare const __VUEPRESS_DEV__: boolean;\ndeclare const BLOG_META_SCOPE: string;\n\nexport const blogCategoryMap = ref(categoryMap);\n\nexport const useBlogCategory = <\n  T extends Record<string, unknown> = Record<string, unknown>\n>(\n  key = \"\"\n): ComputedRef<BlogCategoryData<T>> => {\n  const router = useRouter();\n  const route = useRoute();\n  const routeLocale = useRouteLocale();\n\n  return computed(() => {\n    const mapKey =\n      key ||\n      usePageFrontmatter<{ blog?: BlogCategoryFrontmatterOptions }>().value.blog\n        ?.key ||\n      \"\";\n\n    const routes = router.getRoutes();\n\n    if (!blogCategoryMap.value[mapKey])\n      throw new Error(\n        `useBlogCategory: ${\n          key\n            ? `key ${key} is invalid`\n            : \"can not bind to an existing key on non blog pages\"\n        }`\n      );\n\n    const currentMap = blogCategoryMap.value[mapKey][routeLocale.value];\n    const result: BlogCategoryData<T> = {\n      path: currentMap.path,\n      map: {},\n    };\n\n    for (const category in currentMap.map) {\n      const categoryMap = currentMap.map[category];\n\n      result.map[category] = { path: categoryMap.path, items: [] };\n\n      for (const pageKey of categoryMap.keys) {\n        const route = routes.find(({ name }) => name === pageKey);\n\n        if (route) {\n          const finalRoute = resolveRouteWithRedirect(router, route.path);\n\n          result.map[category].items.push({\n            path: finalRoute.path,\n            info:\n              BLOG_META_SCOPE === \"\"\n                ? <T>finalRoute.meta\n                : <T>finalRoute.meta[BLOG_META_SCOPE],\n          });\n        }\n      }\n\n      if (route.path === categoryMap.path)\n        result.currentItems = result.map[category].items;\n    }\n\n    return result;\n  });\n};\n\n// @ts-ignore\nif (__VUEPRESS_DEV__ && (import.meta.webpackHot || import.meta.hot)) {\n  __VUE_HMR_RUNTIME__[\"updateBlogCategory\"] = (\n    map: Record<string, CategoryMap>\n  ): void => {\n    blogCategoryMap.value = map;\n  };\n}\n","import { typeMap } from \"@temp/blog/type\";\nimport { usePageFrontmatter, useRouteLocale } from \"@vuepress/client\";\nimport { computed, ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { resolveRouteWithRedirect } from \"vuepress-shared/client\";\n\nimport type { ComputedRef } from \"vue\";\nimport type {\n  BlogTypeFrontmatterOptions,\n  TypeMap,\n} from \"../../shared/index.js\";\nimport type { BlogTypeData } from \"../typings.js\";\n\ndeclare const __VUE_HMR_RUNTIME__: Record<string, unknown>;\ndeclare const __VUEPRESS_DEV__: boolean;\ndeclare const BLOG_META_SCOPE: string;\n\nexport const blogTypeMap = ref(typeMap);\n\nexport const useBlogType = <\n  T extends Record<string, unknown> = Record<string, unknown>\n>(\n  key = \"\"\n): ComputedRef<BlogTypeData<T>> => {\n  const router = useRouter();\n  const routeLocale = useRouteLocale();\n\n  return computed(() => {\n    const mapKey =\n      key ||\n      usePageFrontmatter<{ blog?: BlogTypeFrontmatterOptions }>().value.blog\n        ?.key ||\n      \"\";\n\n    if (!blogTypeMap.value[mapKey])\n      throw new Error(\n        `useBlogType: ${\n          key\n            ? `key ${key} is invalid`\n            : \"can not bind to an existing key on non blog pages\"\n        }`\n      );\n\n    const routes = router.getRoutes();\n    const configMap = blogTypeMap.value[mapKey][routeLocale.value];\n    const result: BlogTypeData<T> = {\n      path: configMap.path,\n      items: [],\n    };\n\n    for (const pageKey of configMap.keys) {\n      const route = routes.find(({ name }) => name === pageKey);\n\n      if (route) {\n        const finalRoute = resolveRouteWithRedirect(router, route.path);\n\n        result.items.push({\n          path: finalRoute.path,\n          info:\n            BLOG_META_SCOPE === \"\"\n              ? <T>finalRoute.meta\n              : <T>finalRoute.meta[BLOG_META_SCOPE],\n        });\n      }\n    }\n\n    return result;\n  });\n};\n\n// @ts-ignore\nif (__VUEPRESS_DEV__ && (import.meta.webpackHot || import.meta.hot)) {\n  __VUE_HMR_RUNTIME__[\"updateBlogType\"] = (\n    map: Record<string, TypeMap>\n  ): void => {\n    blogTypeMap.value = map;\n  };\n}\n"],"names":["blogCategoryMap","ref","categoryMap","useBlogCategory","key","router","useRouter","route","useRoute","routeLocale","useRouteLocale","computed","_a","mapKey","usePageFrontmatter","routes","currentMap","result","category","pageKey","name","finalRoute","resolveRouteWithRedirect","map","blogTypeMap","typeMap","useBlogType","configMap"],"mappings":"2UAkBaA,EAAkBC,EAAIC,CAAW,EAEjCC,EAAkB,CAG7BC,EAAM,KAC+B,CACrC,MAAMC,EAASC,IACTC,EAAQC,IACRC,EAAcC,IAEpB,OAAOC,EAAS,IAAM,CA7BxB,IAAAC,EA8BI,MAAMC,EACJT,KACAQ,EAAAE,IAAgE,MAAM,OAAtE,YAAAF,EACI,MACJ,GAEIG,EAASV,EAAO,UAEtB,EAAA,GAAI,CAACL,EAAgB,MAAMa,GACzB,MAAM,IAAI,MACR,oBACET,EACI,OAAOA,eACP,qDAER,EAEF,MAAMY,EAAahB,EAAgB,MAAMa,GAAQJ,EAAY,OACvDQ,EAA8B,CAClC,KAAMD,EAAW,KACjB,IAAK,CAAA,CACP,EAEA,UAAWE,KAAYF,EAAW,IAAK,CACrC,MAAMd,EAAcc,EAAW,IAAIE,GAEnCD,EAAO,IAAIC,GAAY,CAAE,KAAMhB,EAAY,KAAM,MAAO,CAAG,CAAA,EAE3D,UAAWiB,KAAWjB,EAAY,KAAM,CACtC,MAAMK,EAAQQ,EAAO,KAAK,CAAC,CAAE,KAAAK,CAAK,IAAMA,IAASD,CAAO,EAExD,GAAIZ,EAAO,CACT,MAAMc,EAAaC,EAAyBjB,EAAQE,EAAM,IAAI,EAE9DU,EAAO,IAAIC,GAAU,MAAM,KAAK,CAC9B,KAAMG,EAAW,KACjB,KACE,kBAAoB,GACbA,EAAW,KACXA,EAAW,KAAK,gBAC3B,CAAC,CACH,CACF,CAEId,EAAM,OAASL,EAAY,OAC7Be,EAAO,aAAeA,EAAO,IAAIC,GAAU,MAC/C,CAEA,OAAOD,CACT,CAAC,CACH,EAGI,mBAAqB,YAAY,YAAc,YAAY,OAC7D,oBAAoB,mBAClBM,GACS,CACTvB,EAAgB,MAAQuB,CAC1B,GCvEK,MAAMC,EAAcvB,EAAIwB,CAAO,EAEzBC,EAAc,CAGzBtB,EAAM,KAC2B,CACjC,MAAMC,EAASC,EAAU,EACnBG,EAAcC,IAEpB,OAAOC,EAAS,IAAM,CA3BxB,IAAAC,EA4BI,MAAMC,EACJT,KACAQ,EAAAE,IAA4D,MAAM,OAAlE,YAAAF,EACI,MACJ,GAEF,GAAI,CAACY,EAAY,MAAMX,GACrB,MAAM,IAAI,MACR,gBACET,EACI,OAAOA,eACP,qDAER,EAEF,MAAMW,EAASV,EAAO,UAAU,EAC1BsB,EAAYH,EAAY,MAAMX,GAAQJ,EAAY,OAClDQ,EAA0B,CAC9B,KAAMU,EAAU,KAChB,MAAO,CAAA,CACT,EAEA,UAAWR,KAAWQ,EAAU,KAAM,CACpC,MAAMpB,EAAQQ,EAAO,KAAK,CAAC,CAAE,KAAAK,CAAK,IAAMA,IAASD,CAAO,EAExD,GAAIZ,EAAO,CACT,MAAMc,EAAaC,EAAyBjB,EAAQE,EAAM,IAAI,EAE9DU,EAAO,MAAM,KAAK,CAChB,KAAMI,EAAW,KACjB,KACE,kBAAoB,GACbA,EAAW,KACXA,EAAW,KAAK,gBAC3B,CAAC,CACH,CACF,CAEA,OAAOJ,CACT,CAAC,CACH,EAGI,mBAAqB,YAAY,YAAc,YAAY,OAC7D,oBAAoB,eAClBM,GACS,CACTC,EAAY,MAAQD,CACtB"}