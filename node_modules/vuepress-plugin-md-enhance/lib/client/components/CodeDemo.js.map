{"version":3,"file":"CodeDemo.js","sources":["../../../src/client/components/icons.ts","../../../src/client/utils/code-demo/utils.ts","../../../src/client/utils/code-demo/code.ts","../../../src/client/composables/loadScript.ts","../../../src/client/components/CodeDemo.ts"],"sourcesContent":["import { h } from \"vue\";\nimport { IconBase } from \"vuepress-shared/client\";\n\nimport type { FunctionalComponent } from \"vue\";\n\nexport const BackIcon: FunctionalComponent = () =>\n  h(IconBase, { name: \"back\" }, () =>\n    h(\"path\", {\n      d: \"M1014.749 449.156v125.688H260.626l345.64 345.64-89.239 89.237L19.307 512l497.72-497.721 89.238 89.238-345.64 345.64h754.124z\",\n    })\n  );\n\nexport const HomeIcon: FunctionalComponent = () =>\n  h(IconBase, { name: \"home\" }, () =>\n    h(\"path\", {\n      d: \"M780.106 420.978L506.994 147.866 233.882 420.978h.045v455.11H780.06v-455.11h.046zm90.977 90.976V876.09a91.022 91.022 0 01-91.023 91.022H233.927a91.022 91.022 0 01-91.022-91.022V511.954l-67.22 67.175-64.307-64.307 431.309-431.31c35.498-35.498 93.115-35.498 128.614 0l431.309 431.31-64.307 64.307L871.083 512z\",\n    })\n  );\n\nexport const LoadingIcon: FunctionalComponent = () =>\n  h(IconBase, { name: \"loading\" }, () =>\n    [\"0s\", \"-0.333s\", \"-0.667s\"].map((item) =>\n      h(\n        \"circle\",\n        {\n          cx: 512,\n          cy: 512,\n          r: 0,\n          fill: \"none\",\n          stroke: \"currentColor\",\n          \"stroke-width\": \"20\",\n        },\n        [\n          h(\"animate\", {\n            attributeName: \"r\",\n            repeatCount: \"indefinite\",\n            dur: \"1s\",\n            values: \"0;400\",\n            keyTimes: \"0;1\",\n            keySplines: \"0 0.2 0.8 1\",\n            calcMode: \"spline\",\n            begin: item,\n          }),\n          h(\"animate\", {\n            attributeName: \"opacity\",\n            repeatCount: \"indefinite\",\n            dur: \"1s\",\n            values: \"1;0\",\n            keyTimes: \"0;1\",\n            keySplines: \"0.2 0 0.8 1\",\n            calcMode: \"spline\",\n            begin: item,\n          }),\n        ]\n      )\n    )\n  );\n\nexport const CODEPEN_SVG =\n  '<svg class=\"codepen-icon\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\"><path d=\"M123.429 668L468 897.714V692.571L277.143 565.143zM88 585.714L198.286 512 88 438.286v147.428zm468 312L900.571 668 746.857 565.143 556 692.57v205.143zM512 616l155.429-104L512 408 356.571 512zM277.143 458.857L468 331.43V126.286L123.429 356zM825.714 512L936 585.714V438.286zm-78.857-53.143L900.571 356 556 126.286v205.143zM1024 356v312q0 23.429-19.429 36.571l-468 312Q524.571 1024 512 1024t-24.571-7.429l-468-312Q0 691.43 0 668V356q0-23.429 19.429-36.571l468-312Q499.429 0 512 0t24.571 7.429l468 312Q1024 332.57 1024 356z\"/></svg>';\n\nexport const JSFIDDLE_SVG =\n  '<svg class=\"jsfiddle-icon\" viewBox=\"0 0 1170 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"228.516\" height=\"200\"><path d=\"M1028.571 441.143q63.429 26.286 102.572 83.143t39.143 126.571q0 93.714-67.429 160.286T940 877.714q-2.286 0-6.571-.285t-6-.286H232q-97.143-5.714-164.571-71.714T0 645.143q0-62.857 31.429-116t84-84q-6.858-22.286-6.858-46.857 0-65.715 46.858-112T269.143 240q54.286 0 98.286 33.143 42.857-88 127.142-141.714t186.572-53.715q94.857 0 174.857 46t126.571 124.857 46.572 172q0 3.429-.286 10.286t-.286 10.286zm-761.142 152q0 69.714 48 110.286T434.286 744q78.285 0 137.143-56.571-9.143-11.429-27.143-32.286t-24.857-28.857q-38.286 37.143-82.286 37.143-31.429 0-53.429-19.143t-22-50q0-30.286 22-49.715T436 525.143q25.143 0 48.286 12T526 568.57t37.143 42.858 39.428 46.857 44 42.857T702 732.57t69.429 12q69.142 0 116.857-40.857T936 594.857q0-69.143-48-109.714T769.714 444.57Q688 444.571 632 500l53.143 61.714q37.714-36.571 81.143-36.571 29.714 0 52.571 18.857t22.857 48q0 32.571-21.143 52.286T766.857 664q-24.571 0-47.143-12t-41.143-31.429-37.428-42.857-39.714-46.857T557.143 488 502 456.571t-67.714-12q-69.715 0-118.286 40.286t-48.571 108.286z\"/></svg>';\n\nexport const PLAY_SVG = `<svg class=\"icon\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\"><path d=\"M512 74.667C270.933 74.667 74.667 270.933 74.667 512S270.933 949.333 512 949.333 949.333 753.067 949.333 512 753.067 74.667 512 74.667zm0 810.666C307.2 885.333 138.667 716.8 138.667 512S307.2 138.667 512 138.667 885.333 307.2 885.333 512 716.8 885.333 512 885.333z\"/><path d=\"M708.267 465.067 473.6 330.667c-8.533-4.267-17.067-6.4-25.6-6.4-29.867 0-53.333 23.466-53.333 53.333v268.8c0 8.533 2.133 19.2 6.4 25.6 10.666 17.067 27.733 27.733 46.933 27.733 8.533 0 17.067-2.133 25.6-6.4l234.667-134.4c8.533-4.266 14.933-10.666 19.2-19.2 6.4-12.8 8.533-27.733 4.266-40.533-2.133-14.933-10.666-25.6-23.466-34.133zM458.667 627.2V396.8L661.333 512 458.667 627.2z\"/></svg>`;\n\nexport const CODE_SVG = `<svg class=\"icon\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"200\"><path d=\"M240.496 272c-13.504 0-25.664 5.632-34.384 14.608l-.048-.048-189.216 189.2A47.664 47.664 0 0 0 0 512c0 13.504 5.616 25.664 14.592 34.368l-.032.064 192 192 .048-.064A47.68 47.68 0 0 0 240 752a48 48 0 0 0 48-48c0-12.992-5.216-24.752-13.616-33.392l.048-.048-158.304-158.32 157.808-157.808-.048-.048A47.808 47.808 0 0 0 288.496 320a48 48 0 0 0-48-48zm784 240c0-14.56-6.608-27.44-16.848-36.24l-189.216-189.2-.032.048A47.872 47.872 0 0 0 784 272a48 48 0 0 0-48 48c0 13.504 5.632 25.664 14.608 34.384l-.048.048L908.368 512.24l-158.32 158.32.048.048A47.808 47.808 0 0 0 736.48 704a48 48 0 0 0 48 48c12.992 0 24.752-5.216 33.408-13.632l.048.064 192-192-.048-.064A47.68 47.68 0 0 0 1024.496 512zM640 128c-20.8 0-38.496 13.232-45.168 31.712L339.2 830.784a48 48 0 0 0 89.968 33.504L684.8 193.216A48 48 0 0 0 640 128z\"/></svg>`;\n","import type { Code } from \"./typings.js\";\nimport type { CodeDemoOptions } from \"../../../shared/index.js\";\n\ndeclare const CODE_DEMO_OPTIONS: CodeDemoOptions;\n\nexport const options = CODE_DEMO_OPTIONS;\n\nexport type PreProcessorType = \"html\" | \"js\" | \"css\";\n\nexport const preProcessorConfig: Record<\n  PreProcessorType,\n  {\n    types: string[];\n    map: Record<string, string | undefined>;\n  }\n> = {\n  html: {\n    types: [\"html\", \"slim\", \"haml\", \"md\", \"markdown\", \"vue\"],\n    map: {\n      html: \"none\",\n      vue: \"none\",\n      md: \"markdown\",\n    },\n  },\n  js: {\n    types: [\n      \"js\",\n      \"javascript\",\n      \"coffee\",\n      \"coffeescript\",\n      \"ts\",\n      \"typescript\",\n      \"ls\",\n      \"livescript\",\n    ],\n    map: {\n      js: \"none\",\n      javascript: \"none\",\n      coffee: \"coffeescript\",\n      ls: \"livescript\",\n      ts: \"typescript\",\n    },\n  },\n  css: {\n    types: [\"css\", \"less\", \"sass\", \"scss\", \"stylus\", \"styl\"],\n    map: {\n      css: \"none\",\n      styl: \"stylus\",\n    },\n  },\n};\n\nexport const h = (\n  tag: string,\n  attrs: Record<string, string>,\n  children?: HTMLElement[]\n): HTMLElement => {\n  const node = document.createElement(tag);\n\n  attrs &&\n    Object.keys(attrs).forEach((key) => {\n      if (!key.indexOf(\"data\")) {\n        const k = key.replace(\"data\", \"\");\n\n        node.dataset[k] = attrs[key];\n\n        // @ts-ignore\n      } else node[key] = attrs[key];\n    });\n\n  if (children)\n    children.forEach((child) => {\n      node.appendChild(child);\n    });\n\n  return node;\n};\n\nexport const getConfig = (\n  config: Partial<CodeDemoOptions>\n): CodeDemoOptions => ({\n  ...options,\n  ...config,\n  jsLib: Array.from(\n    new Set([...(options.jsLib || []), ...(config.jsLib || [])])\n  ),\n  cssLib: Array.from(\n    new Set([...(options.cssLib || []), ...(config.cssLib || [])])\n  ),\n});\n\nexport const loadScript = (\n  state: Record<string, Promise<void>>,\n  link: string\n): Promise<void> => {\n  if (state[link] !== undefined) return state[link];\n\n  const loadEvent = new Promise<void>((resolve) => {\n    const script = document.createElement(\"script\");\n\n    script.src = link;\n    document.querySelector(\"body\")?.appendChild(script);\n\n    script.onload = (): void => {\n      resolve();\n    };\n  });\n\n  state[link] = loadEvent;\n\n  return loadEvent;\n};\n\nexport const injectCSS = (shadowRoot: ShadowRoot, code: Code): void => {\n  if (\n    code.css &&\n    // style not injected\n    Array.from(shadowRoot.childNodes).every(\n      (element) => element.nodeName !== \"STYLE\"\n    )\n  ) {\n    const style = h(\"style\", { innerHTML: code.css });\n\n    shadowRoot.appendChild(style);\n  }\n};\n\nexport const injectScript = (\n  id: string,\n  shadowRoot: ShadowRoot,\n  code: Code\n): void => {\n  const scriptText = code.getScript();\n\n  if (\n    scriptText &&\n    // style not injected\n    Array.from(shadowRoot.childNodes).every(\n      (element) => element.nodeName !== \"SCRIPT\"\n    )\n  ) {\n    const script = document.createElement(\"script\");\n\n    script.appendChild(\n      document.createTextNode(\n        // here we are fixing `document` variable back to shadowDOM\n        `{const document=window.document.querySelector('#${id} .code-demo-container').shadowRoot;\\n${scriptText}}`\n      )\n    );\n    shadowRoot.appendChild(script);\n  }\n};\n","import { getConfig, preProcessorConfig } from \"./utils.js\";\n\nimport type Babel from \"@babel/core\";\nimport type { Code, CodeType } from \"./typings.js\";\nimport type { PreProcessorType } from \"./utils.js\";\nimport type { CodeDemoOptions } from \"../../../shared/index.js\";\n\ndeclare global {\n  interface Window {\n    Babel: typeof Babel;\n  }\n}\n\nexport const getCode = (code: Record<string, string>): CodeType => {\n  const languages = Object.keys(code);\n  const result: CodeType = {\n    html: [],\n    js: [],\n    css: [],\n    isLegal: false,\n  };\n\n  (<PreProcessorType[]>[\"html\", \"js\", \"css\"]).forEach((type) => {\n    const match = languages.filter((language) =>\n      preProcessorConfig[type].types.includes(language)\n    );\n\n    if (match.length) {\n      const language = match[0];\n\n      result[type] = [\n        code[language].replace(/^\\n|\\n$/g, \"\"),\n        preProcessorConfig[type].map[language] || language,\n      ];\n    }\n  });\n\n  result.isLegal =\n    (!result.html.length || result.html[1] === \"none\") &&\n    (!result.js.length || result.js[1] === \"none\") &&\n    (!result.css.length || result.css[1] === \"none\");\n\n  return result;\n};\n\nconst handleHTML = (html: string): string =>\n  html\n    .replace(/<br \\/>/g, \"<br>\")\n    .replace(/<((\\S+)[^<]*?)\\s+\\/>/g, \"<$1></$2>\");\n\nconst getHtmlTemplate = (html: string): string =>\n  `<div id=\"app\">\\n${handleHTML(html)}\\n</div>`;\n\nconst getReactTemplate = (code: string): string =>\n  `${code\n    .replace(\"export default \", \"const $reactApp = \")\n    .replace(\n      /App\\.__style__(\\s*)=(\\s*)`([\\s\\S]*)?`/,\n      \"\"\n    )};\\nReactDOM.createRoot(document.getElementById(\"app\")).render(React.createElement($reactApp))`;\n\nconst getVueJsTemplate = (js: string): string =>\n  js\n    .replace(\n      /export\\s+default\\s*\\{(\\n*[\\s\\S]*)\\n*\\}\\s*;?$/u,\n      \"Vue.createApp({$1}).mount('#app')\"\n    )\n    .replace(\n      /export\\s+default\\s*define(Async)?Component\\s*\\(\\s*\\{(\\n*[\\s\\S]*)\\n*\\}\\s*\\)\\s*;?$/u,\n      \"Vue.createApp({$1}).mount('#app')\"\n    )\n    .trim();\n\nexport const wrapper = (scriptStr: string): string =>\n  `(function(exports){var module={};module.exports=exports;${scriptStr};return module.exports.__esModule?module.exports.default:module.exports;})({})`;\n\nexport const getNormalCode = (\n  code: CodeType,\n  config: Partial<CodeDemoOptions>\n): Code => {\n  const codeConfig = getConfig(config);\n  const js = code.js[0] || \"\";\n\n  return {\n    ...codeConfig,\n    html: handleHTML(code.html[0] || \"\"),\n    js,\n    css: code.css[0] || \"\",\n    isLegal: code.isLegal,\n    getScript: (): string =>\n      codeConfig.useBabel\n        ? window.Babel.transform(js, { presets: [\"es2015\"] })?.code || \"\"\n        : js,\n  };\n};\n\nexport const getVueCode = (\n  code: CodeType,\n  config: Partial<CodeDemoOptions>\n): Code => {\n  const codeConfig = getConfig(config);\n\n  const vueTemplate = code.html[0] || \"\";\n  const htmlBlock = /<template>([\\s\\S]+)<\\/template>/u.exec(vueTemplate);\n  const jsBlock = /<script(\\s*lang=(['\"])(.*?)\\2)?>([\\s\\S]+)<\\/script>/u.exec(\n    vueTemplate\n  );\n  const cssBlock =\n    /<style(\\s*lang=(['\"])(.*?)\\2)?\\s*(?:scoped)?>([\\s\\S]+)<\\/style>/u.exec(\n      vueTemplate\n    );\n  const html = htmlBlock ? htmlBlock[1].replace(/^\\n|\\n$/g, \"\") : \"\";\n  const [js = \"\", jsLang = \"\"] = jsBlock\n    ? [jsBlock[4].replace(/^\\n|\\n$/g, \"\"), jsBlock[3]]\n    : [];\n  const [css = \"\", cssLang = \"\"] = cssBlock\n    ? [cssBlock[4].replace(/^\\n|\\n$/g, \"\"), cssBlock[3]]\n    : [];\n\n  const isLegal = jsLang === \"\" && (cssLang === \"\" || cssLang === \"css\");\n\n  return {\n    ...codeConfig,\n    html: getHtmlTemplate(html),\n    js: getVueJsTemplate(js),\n    css,\n    isLegal,\n    jsLib: [codeConfig.vue, ...codeConfig.jsLib],\n    getScript: (): string => {\n      const scriptStr = config.useBabel\n        ? window.Babel?.transform(js, { presets: [\"es2015\"] })?.code || \"\"\n        : js.replace(/export\\s+default/u, \"return\");\n\n      return `const app=window.document.createElement('div');document.firstElementChild.appendChild(app);const appOptions=${wrapper(\n        scriptStr\n      )};appOptions.template=\\`${html.replace(\n        \"`\",\n        '\\\\`\"'\n      )}\\`;window.Vue.createApp(appOptions).mount(app);`;\n    },\n  };\n};\n\nexport const getReactCode = (\n  code: CodeType,\n  config: Partial<CodeDemoOptions>\n): Code => {\n  const codeConfig = getConfig(config);\n\n  return {\n    ...codeConfig,\n    html: getHtmlTemplate(\"\"),\n    js: getReactTemplate(code.js[0] || \"\"),\n    css:\n      code.css[0] ||\n      (code.js[0]\n        ? code.js[0]\n            .replace(/App\\.__style__(?:\\s*)=(?:\\s*)`([\\s\\S]*)?`/, \"$1\")\n            .trim()\n        : \"\"),\n    isLegal: code.isLegal,\n    jsLib: [codeConfig.react, codeConfig.reactDOM, ...codeConfig.jsLib],\n    jsx: true,\n    getScript: (): string => {\n      const scriptStr =\n        window.Babel?.transform(code.js[0] || \"\", {\n          presets: [\"es2015\", \"react\"],\n        })?.code || \"\";\n\n      return `window.ReactDOM.createRoot(document.firstElementChild).render(window.React.createElement(${wrapper(\n        scriptStr\n      )}))`;\n    },\n  };\n};\n","import { loadScript } from \"../utils/index.js\";\nimport type { Code } from \"../utils/index.js\";\n\nexport type ScriptLoadState = Record<string, Promise<void>>;\n\nconst state: ScriptLoadState = {};\n\nexport const useState = (): ScriptLoadState => state;\n\nexport const loadReact = (code: Code): Promise<void[]> =>\n  Promise.all([\n    loadScript(state, code.babel),\n    loadScript(state, code.react),\n    loadScript(state, code.reactDOM),\n  ]);\n\nexport const loadVue = (code: Code): Promise<void[]> => {\n  const promises = [loadScript(state, code.vue)];\n\n  if (code.useBabel) promises.push(loadScript(state, code.babel));\n\n  return Promise.all(promises);\n};\n\nexport const loadNormal = (code: Code): Promise<void> =>\n  code.useBabel ? loadScript(state, code.babel) : Promise.resolve();\n","import { computed, defineComponent, h, onMounted, ref } from \"vue\";\nimport { atou } from \"vuepress-shared/client\";\nimport { CODEPEN_SVG, JSFIDDLE_SVG, LoadingIcon } from \"./icons.js\";\nimport { loadNormal, loadReact, loadVue } from \"../composables/index.js\";\nimport {\n  injectCSS,\n  injectScript,\n  getCode,\n  getReactCode,\n  getNormalCode,\n  getVueCode,\n} from \"../utils/index.js\";\n\nimport type { PropType, VNode } from \"vue\";\nimport type { CodeDemoOptions } from \"../../shared/index.js\";\n\nimport \"balloon-css/balloon.css\";\nimport \"../styles/code-demo.scss\";\n\ndeclare const MARKDOWN_ENHANCE_DELAY: number;\n\nexport default defineComponent({\n  name: \"CodeDemo\",\n\n  props: {\n    /**\n     * Code demo id\n     *\n     * 代码演示 id\n     */\n    id: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Code demo type\n     *\n     * 代码演示类型\n     */\n    type: {\n      type: String as PropType<\"normal\" | \"vue\" | \"react\">,\n      default: \"normal\",\n    },\n\n    /**\n     * Code demo title\n     *\n     * 代码演示标题\n     */\n    title: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Code demo config\n     *\n     * 代码演示配置\n     */\n    config: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Code demo code content\n     *\n     * 代码演示代码内容\n     */\n    code: {\n      type: String,\n      required: true,\n    },\n  },\n\n  setup(props, { slots }) {\n    const isExpanded = ref(false);\n    const demoWrapper = ref<HTMLDivElement>();\n    const codeContainer = ref<HTMLDivElement>();\n    const height = ref(\"0\");\n    const loaded = ref(false);\n\n    const config = computed(\n      () =>\n        <Partial<CodeDemoOptions>>(\n          JSON.parse(props.config ? atou(props.config) : \"{}\")\n        )\n    );\n\n    const codeType = computed(() => {\n      const codeConfig = <Record<string, string>>JSON.parse(atou(props.code));\n\n      return getCode(codeConfig);\n    });\n\n    const code = computed(() =>\n      props.type === \"react\"\n        ? getReactCode(codeType.value, config.value)\n        : props.type === \"vue\"\n        ? getVueCode(codeType.value, config.value)\n        : getNormalCode(codeType.value, config.value)\n    );\n\n    const isLegal = computed(() => code.value.isLegal);\n\n    const initDom = (innerHTML = false): void => {\n      // attach a shadow root to demo\n\n      const shadowRoot = demoWrapper.value!.attachShadow({ mode: \"open\" });\n      const appElement = document.createElement(\"div\");\n\n      appElement.classList.add(\"code-demo-app\");\n      shadowRoot.appendChild(appElement);\n\n      if (isLegal.value) {\n        if (innerHTML) appElement.innerHTML = code.value.html;\n        injectCSS(shadowRoot, code.value);\n        injectScript(props.id, shadowRoot, code.value);\n\n        height.value = \"0\";\n      } else height.value = \"auto\";\n\n      loaded.value = true;\n    };\n\n    const loadDemo = (): Promise<void> => {\n      switch (props.type) {\n        case \"react\": {\n          return loadReact(code.value).then(() => initDom());\n        }\n        case \"vue\": {\n          return loadVue(code.value).then(() => initDom());\n        }\n\n        default: {\n          return loadNormal(code.value).then(() => initDom(true));\n        }\n      }\n    };\n\n    onMounted(() => {\n      setTimeout(() => {\n        void loadDemo();\n      }, MARKDOWN_ENHANCE_DELAY);\n    });\n\n    return (): VNode =>\n      h(\"div\", { class: \"code-demo-wrapper\", id: props.id }, [\n        loaded.value ? null : h(\"div\", { class: \"loading\" }, h(LoadingIcon)),\n        h(\"div\", { class: \"code-demo-header\" }, [\n          code.value.isLegal\n            ? h(\"button\", {\n                class: [\"toggle-button\", isExpanded.value ? \"down\" : \"right\"],\n                onClick: () => {\n                  height.value = isExpanded.value\n                    ? \"0\"\n                    : `${codeContainer.value!.clientHeight + 13.8}px`;\n                  isExpanded.value = !isExpanded.value;\n                },\n              })\n            : null,\n          props.title\n            ? h(\"span\", { class: \"title\" }, decodeURIComponent(props.title))\n            : null,\n\n          code.value.isLegal && code.value.jsfiddle !== false\n            ? h(\n                \"form\",\n                {\n                  class: \"code-demo-jsfiddle\",\n                  target: \"_blank\",\n                  action: \"https://jsfiddle.net/api/post/library/pure/\",\n                  method: \"post\",\n                },\n                [\n                  h(\"input\", {\n                    type: \"hidden\",\n                    name: \"html\",\n                    value: code.value.html,\n                  }),\n                  h(\"input\", {\n                    type: \"hidden\",\n                    name: \"js\",\n                    value: code.value.js,\n                  }),\n                  h(\"input\", {\n                    type: \"hidden\",\n                    name: \"css\",\n                    value: code.value.css,\n                  }),\n                  h(\"input\", { type: \"hidden\", name: \"wrap\", value: \"1\" }),\n                  h(\"input\", { type: \"hidden\", name: \"panel_js\", value: \"3\" }),\n                  h(\"input\", {\n                    type: \"hidden\",\n                    name: \"resources\",\n                    value: [...code.value.cssLib, ...code.value.jsLib].join(\n                      \",\"\n                    ),\n                  }),\n                  h(\"button\", {\n                    type: \"submit\",\n                    class: \"jsfiddle-button\",\n                    innerHTML: JSFIDDLE_SVG,\n                    \"aria-label\": \"JSFiddle\",\n                    \"data-balloon-pos\": \"up\",\n                  }),\n                ]\n              )\n            : null,\n\n          !code.value.isLegal || code.value.codepen !== false\n            ? h(\n                \"form\",\n                {\n                  class: \"code-demo-codepen\",\n                  target: \"_blank\",\n                  action: \"https://codepen.io/pen/define\",\n                  method: \"post\",\n                },\n                [\n                  h(\"input\", {\n                    type: \"hidden\",\n                    name: \"data\",\n                    value: JSON.stringify({\n                      html: code.value.html,\n                      js: code.value.js,\n                      css: code.value.css,\n                      // eslint-disable-next-line @typescript-eslint/naming-convention\n                      js_external: code.value.jsLib.join(\";\"),\n                      // eslint-disable-next-line @typescript-eslint/naming-convention\n                      css_external: code.value.cssLib.join(\";\"),\n                      layout: code.value.codepenLayout,\n                      // eslint-disable-next-line @typescript-eslint/naming-convention\n                      html_pre_processor: codeType.value\n                        ? codeType.value.html[1]\n                        : \"none\",\n                      // eslint-disable-next-line @typescript-eslint/naming-convention\n                      js_pre_processor: codeType.value\n                        ? codeType.value.js[1]\n                        : code.value.jsx\n                        ? \"babel\"\n                        : \"none\",\n                      // eslint-disable-next-line @typescript-eslint/naming-convention\n                      css_pre_processor: codeType.value\n                        ? codeType.value.css[1]\n                        : \"none\",\n                      editors: code.value.codepenEditors,\n                    }),\n                  }),\n                  h(\"button\", {\n                    type: \"submit\",\n                    innerHTML: CODEPEN_SVG,\n                    class: \"codepen-button\",\n                    \"aria-label\": \"Codepen\",\n                    \"data-balloon-pos\": \"up\",\n                  }),\n                ]\n              )\n            : null,\n        ]),\n\n        h(\"div\", {\n          ref: demoWrapper,\n          class: \"code-demo-container\",\n          style: {\n            display: isLegal.value && loaded.value ? \"block\" : \"none\",\n          },\n        }),\n\n        h(\n          \"div\",\n          { class: \"code-demo-code-wrapper\", style: { height: height.value } },\n          h(\n            \"div\",\n            {\n              ref: codeContainer,\n              class: \"code-demo-codes\",\n            },\n            slots[\"default\"]?.()\n          )\n        ),\n      ]);\n  },\n});\n"],"names":["LoadingIcon","h","IconBase","item","CODEPEN_SVG","JSFIDDLE_SVG","options","preProcessorConfig","tag","attrs","children","node","key","k","child","getConfig","config","loadScript","state","link","loadEvent","resolve","_a","script","injectCSS","shadowRoot","code","element","style","injectScript","id","scriptText","getCode","languages","result","type","match","language","handleHTML","html","getHtmlTemplate","getReactTemplate","getVueJsTemplate","js","wrapper","scriptStr","getNormalCode","codeConfig","getVueCode","vueTemplate","htmlBlock","jsBlock","cssBlock","jsLang","css","cssLang","isLegal","_b","getReactCode","loadReact","loadVue","promises","loadNormal","CodeDemo","defineComponent","props","slots","isExpanded","ref","demoWrapper","codeContainer","height","loaded","computed","atou","codeType","initDom","innerHTML","appElement","loadDemo","onMounted"],"mappings":"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"}