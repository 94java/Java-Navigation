{"version":3,"file":"index.js","sources":["../../../src/client/compact/components/CodeGroup.ts"],"sourcesContent":["import { defineComponent, h, onBeforeUpdate, ref } from \"vue\";\nimport type { Component, FunctionalComponent, VNode } from \"vue\";\n\n// eslint-disable-next-line @typescript-eslint/naming-convention\ndeclare const __VUEPRESS_DEV__: boolean;\n\nimport \"../styles/code-group.scss\";\n\nexport interface CodeGroupItemProps {\n  title: string;\n  active?: boolean;\n}\n\nexport const CodeGroupItem: FunctionalComponent<CodeGroupItemProps> = (\n  { active = false },\n  { slots }\n): VNode =>\n  h(\n    \"div\",\n    {\n      class: [\"code-group-item\", { active }],\n      \"aria-selected\": active,\n    },\n    slots[\"default\"]?.()\n  );\n\nCodeGroupItem.displayName = \"CodeGroupItem\";\n\nexport const CodeGroup = defineComponent({\n  name: \"CodeGroup\",\n\n  setup(_props, { slots }) {\n    // index of current active item\n    const activeIndex = ref(-1);\n\n    // refs of the tab buttons\n    const tabRefs = ref<HTMLUListElement[]>([]);\n\n    // after removing a code-group-item, we need to clear the ref\n    // of the removed item to avoid issues caused by HMR\n    if (__VUEPRESS_DEV__)\n      onBeforeUpdate(() => {\n        tabRefs.value = [];\n      });\n\n    // activate next tab\n    const activateNext = (i = activeIndex.value): void => {\n      activeIndex.value = i < tabRefs.value.length - 1 ? i + 1 : 0;\n      tabRefs.value[activeIndex.value].focus();\n    };\n\n    // activate previous tab\n    const activatePrev = (i = activeIndex.value): void => {\n      activeIndex.value = i > 0 ? i - 1 : tabRefs.value.length - 1;\n      tabRefs.value[activeIndex.value].focus();\n    };\n\n    // handle keyboard event\n    const keyboardHandler = (event: KeyboardEvent, i: number): void => {\n      if (event.key === \" \" || event.key === \"Enter\") {\n        event.preventDefault();\n        activeIndex.value = i;\n      } else if (event.key === \"ArrowRight\") {\n        event.preventDefault();\n        activateNext(i);\n      } else if (event.key === \"ArrowLeft\") {\n        event.preventDefault();\n        activatePrev(i);\n      }\n    };\n\n    return (): VNode | null => {\n      // NOTICE: here we put the `slots.default()` inside the render function to make\n      // the slots reactive, otherwise the slot content wonâ€™t be changed once the\n      // `setup()` function of current component is called\n\n      // get children code-group-item\n      const items = (slots[\"default\"]?.() || [])\n        .filter((vnode) => (vnode.type as Component).name === \"CodeGroupItem\")\n        .map((vnode) => {\n          if (vnode.props === null) vnode.props = {};\n\n          return vnode as VNode & { props: Exclude<VNode[\"props\"], null> };\n        });\n\n      // do not render anything if there is no code-group-item\n      if (items.length === 0) return null;\n\n      // if `activeIndex` is invalid\n      if (activeIndex.value < 0 || activeIndex.value > items.length - 1) {\n        // find the index of the code-group-item with `active` props\n        activeIndex.value = items.findIndex((vnode) => \"active\" in vnode.props);\n\n        // if there is no `active` props on code-group-item, set the first item active\n        if (activeIndex.value === -1) activeIndex.value = 0;\n      }\n      // set the active item\n      else\n        items.forEach((vnode, index) => {\n          vnode.props[\"active\"] = index === activeIndex.value;\n        });\n\n      return h(\"div\", { class: \"code-group\" }, [\n        h(\n          \"div\",\n          { class: \"code-group-nav\" },\n          items.map((vnode, index) => {\n            const isActive = index === activeIndex.value;\n\n            return h(\n              \"button\",\n              {\n                ref: (element) => {\n                  if (element) tabRefs.value[index] = <HTMLUListElement>element;\n                },\n                class: [\"code-group-nav-tab\", { active: isActive }],\n                \"aria-pressed\": isActive,\n                \"aria-expanded\": isActive,\n                onClick: () => {\n                  activeIndex.value = index;\n                },\n                onKeydown: (event: KeyboardEvent) =>\n                  keyboardHandler(event, index),\n              },\n              <string[]>vnode.props[\"title\"]\n            );\n          })\n        ),\n        items,\n      ]);\n    };\n  },\n});\n"],"names":["CodeGroupItem","active","slots","_a","h","CodeGroup","defineComponent","_props","activeIndex","ref","tabRefs","onBeforeUpdate","activateNext","i","activatePrev","keyboardHandler","event","items","vnode","index","isActive","element"],"mappings":"2GAaa,MAAAA,EAAyD,CACpE,CAAE,OAAAC,EAAS,EAAM,EACjB,CAAE,MAAAC,CAAM,IACD,CAhBT,IAAAC,EAiBE,OAAAC,EACE,MACA,CACE,MAAO,CAAC,kBAAmB,CAAE,OAAAH,CAAO,CAAC,EACrC,gBAAiBA,CACnB,GACAE,EAAAD,EAAM,UAAN,KAAA,OAAAC,EAAA,KAAAD,CAAAA,CACF,CAEF,EAAAF,EAAc,YAAc,gBAErB,MAAMK,EAAYC,EAAgB,CACvC,KAAM,YAEN,MAAMC,EAAQ,CAAE,MAAAL,CAAM,EAAG,CAEvB,MAAMM,EAAcC,EAAI,EAAE,EAGpBC,EAAUD,EAAwB,CAAA,CAAE,EAItC,kBACFE,EAAe,IAAM,CACnBD,EAAQ,MAAQ,CAAA,CAClB,CAAC,EAGH,MAAME,EAAe,CAACC,EAAIL,EAAY,QAAgB,CACpDA,EAAY,MAAQK,EAAIH,EAAQ,MAAM,OAAS,EAAIG,EAAI,EAAI,EAC3DH,EAAQ,MAAMF,EAAY,OAAO,MACnC,CAAA,EAGMM,EAAe,CAACD,EAAIL,EAAY,QAAgB,CACpDA,EAAY,MAAQK,EAAI,EAAIA,EAAI,EAAIH,EAAQ,MAAM,OAAS,EAC3DA,EAAQ,MAAMF,EAAY,OAAO,MACnC,CAAA,EAGMO,EAAkB,CAACC,EAAsBH,IAAoB,CAC7DG,EAAM,MAAQ,KAAOA,EAAM,MAAQ,SACrCA,EAAM,eAAA,EACNR,EAAY,MAAQK,GACXG,EAAM,MAAQ,cACvBA,EAAM,iBACNJ,EAAaC,CAAC,GACLG,EAAM,MAAQ,cACvBA,EAAM,eAAe,EACrBF,EAAaD,CAAC,EAElB,EAEA,MAAO,IAAoB,CAvE/B,IAAAV,EA6EM,MAAMc,KAASd,EAAAD,EAAM,UAAN,KAAA,OAAAC,EAAA,KAAAD,KAAwB,CAAA,GACpC,OAAQgB,GAAWA,EAAM,KAAmB,OAAS,eAAe,EACpE,IAAKA,IACAA,EAAM,QAAU,OAAMA,EAAM,MAAQ,CAAA,GAEjCA,EACR,EAGH,OAAID,EAAM,SAAW,EAAU,MAG3BT,EAAY,MAAQ,GAAKA,EAAY,MAAQS,EAAM,OAAS,GAE9DT,EAAY,MAAQS,EAAM,UAAWC,GAAU,WAAYA,EAAM,KAAK,EAGlEV,EAAY,QAAU,KAAIA,EAAY,MAAQ,IAIlDS,EAAM,QAAQ,CAACC,EAAOC,IAAU,CAC9BD,EAAM,MAAM,OAAYC,IAAUX,EAAY,KAChD,CAAC,EAEIJ,EAAE,MAAO,CAAE,MAAO,YAAa,EAAG,CACvCA,EACE,MACA,CAAE,MAAO,gBAAiB,EAC1Ba,EAAM,IAAI,CAACC,EAAOC,IAAU,CAC1B,MAAMC,EAAWD,IAAUX,EAAY,MAEvC,OAAOJ,EACL,SACA,CACE,IAAMiB,GAAY,CACZA,IAASX,EAAQ,MAAMS,GAA2BE,EACxD,EACA,MAAO,CAAC,qBAAsB,CAAE,OAAQD,CAAS,CAAC,EAClD,eAAgBA,EAChB,gBAAiBA,EACjB,QAAS,IAAM,CACbZ,EAAY,MAAQW,CACtB,EACA,UAAYH,GACVD,EAAgBC,EAAOG,CAAK,CAChC,EACUD,EAAM,MAAM,KACxB,CACF,CAAC,CACH,EACAD,CACF,CAAC,EACH,CACF,CACF,CAAC"}