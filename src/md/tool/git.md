---
title: "Git"
order: 5
category:
  - 工具 | 部署
---

# Git

## 一、概述及安装

> 版本控制：无论是代码编写，还是文档编写，我们都会遇到对文档内容反复修改的情况

**Git和SVN的对比**

- SVN是集中式版本控制系统，版本库是集中放在中央服务器的，而开发人员工作的时候，用的都是自己的电脑，所以首先要从中央服务器下载最新的版本，然后开发，开发完后，需要把自己开发的代码提交到中央服务器
- Git是在2005年，Liunx创建者为了帮助全球的开发者，维护Linux系统内核的开发，而开发了自己的开源分布式版本控制工具，分为两种类型的仓库，本地仓库和远程仓库

**Git下载和安装**

- 官网下载地址：<https://git-scm.com/downloads>
- Git GUI : Git提供的图形界面工具
- Git Bash：Git提供的命令行工具
- 运行Git命令客户端，使用git --version命令，可以查看git版本

## 二、基本操作

### 1、本地仓库

- 工作目录：Working Tree		----代码存放的位置
- 暂存区(Index)：代码提交到仓库之前的临时存储空间
- 本地历史仓库(Repository)/版本库：存放不同版本的代码，例如：（完成了项目10%的代码、完成了项目20%的代码）

工作目录---->暂存区---->本地历史仓库（版本库）

> 版本库指.git隐藏文件夹，工作目录是和.git同级的目录，暂存区是.git隐藏文件中的index

### 2、Git常用命令

- `git init`：初始化，创建git仓库
- `git status`：查看git状态（文件是否进行了添加、提交操作）
- `git add 文件名（支持*通配）`：添加，将指定文件添加到暂存区
- `git reset 文件名（支持*通配）`：将指定文件从暂存区移除（取消git版本跟踪）
  - 也可以通过`git reset --hard 唯一标识`，指定版本，回退到对应的版本（唯一标识通过log查询）
- `git commit -m '描述信息' [文件名（支持*通配）]`：提交，将暂存区文件提交到历史仓库
- `git log`：查看日志（git提交的历史日志）

**基本操作流程**

1. 创建工作目录，初始化本地git仓库（初始化本地仓库使用不多，更多的是clone远程仓库）
2. 新建一个test.txt文件（暂不执行添加操作）
3. 使用status命令，查看状态
4. 使用add命令添加，并查看状态
5. 使用commit命令，提交到本地历史仓库
6. 使用log命令，查看日志
7. 修改test.txt文件
8. 添加并提交，查看日志

### 3、Git版本管理

- 准备工作：
  1. 查看log日志
     	
     	`git reflog`：可以查看所有分支的所有操作记录（包括已经被删除的commit记录的操作）
     	
  2. 增加一次新的修改记录
  
- 主要指令
  
  `git reflog`
  
  `git reset --hard 版本唯一索引值`：将代码切换到指定版本

### 4、远程仓库

**工作流程**

- 推送(push)：推送本地仓库内容到远程仓库
- 克隆(clone)：将远程仓库中的内容复制到本地仓库
- 拉取(pull)：更新远程仓库中新的内容到本地仓库（和克隆有区别）

**常用命令**

- `git remote [-v]`：查看远程仓库（shortname和url）

- `git remote add <shortname> <url>`：添加一个新的远程Git仓库，同时指定一个可以引用的简写（一般origin）

- `git clone`：从远程仓库克隆

- `git pull <shortname> <url>`：从远程仓库拉取

  > 如果当前本地仓库不是从远程仓库克隆，而是在本地创建后关联的远程仓库，并且仓库中存在文件，此时从远程仓库拉取文件的时候会报错（fatal: refusing to merge unrelated histories）
  >
  > 解决此问题可以在git pull 命令后加入参数`--allow-unrelated-histories`

- `git push <shortname> <url>`：推送到远程仓库

### 5、常见远程仓库平台

**GitHub：**

- 域名：<https://github.com>
- 介绍：GitHub是全球最大的开源项目托管平台，俗称大型程序员社区化交友网站
  			各类好玩有趣的开源项目，只有想不到，没有找不到

**码云：**

- 域名：<https://gitee.com>
- 介绍：码云是全国最大的开源项目托管平台，良心平台，速度快，提供免费私有库

**远程仓库平台操作**

1. 先有本地仓库，远程仓库为空
2. 先有远程仓库，本地仓库为空

*情况1*

1. 创建远程仓库

2. 将项目从本地仓库，推送到远程仓库
   
在推送代码之前，需要先配置SSH公钥
   
   > 生成SSH公钥步骤：
   >
   > 1. 设置Git账户
   >    查看git账户：`git config user.name`
   >    查看git邮箱：`git config user.email`
   >    设置全局账户名和邮箱：`git config --global user.name "账户名"`
   >    											`git config --global user.email "邮箱"`
   > 2. 生成SSH公钥
   >    查看是否生成过SSH公钥：`cd ~/.ssh`
   >    生成SSH：`ssh-keygen -t rsa -C "邮箱"`                这里需要敲击三次回车
   >    查看SSH：`cat ~/.ssh/id_rsa.pub`
   > 3. 设置账户公钥（在远程仓库平台设置）
> 4. 公钥测试：`ssh -T git@gitee.com`
   
3. 推送到远程平台

   1. 为远程仓库的URL（网址），自定义仓库名称：`git remote add 远程名称 远程仓库URL`
   2. 推送：`git push -u 仓库名称 分支名`

*情况2*

1. 将远程仓库的代码，克隆到本地仓库：`git clone 仓库地址`
2. 创建新文件，添加并提交到本地仓库
3. 推送至远程仓库
4. 项目拉取更新：`git pull 远程仓库名 分支名`

- 代码冲突

  ![](http://images.hellocode.top/%E4%BB%A3%E7%A0%81%E5%86%B2%E7%AA%81.png)

  	**<<<<<<<和>>>>>>>>>中间的内容，就是冲突部分**

  1. 修改冲突行，保存，即可解决冲突
  2. 重新add冲突文件并commit到本地仓库，重新push到远程

### 6、分支管理

> 分支是Git使用过程中非常重要的概念。使用分支意味着你可以把你的工作从开发主线上分离开来，以免影响开发主线。同一个仓库可以有多个分支，各分支相互独立，互不干扰。

通过`git init`命令创建仓库时默认会创建一个master分支

- 分支：由每次提交的代码，串成的一条时间线

- 特点：两条时间线，并行工作，互不打扰，多条时间线可以合并


**使用场景**

1. 周期较长的模块开发
2. 尝试性的模块开发

**工作流程**

1. 查看分支：`git branch`

   - 列出所有远程分支：`git branch -r`
   - 列出所有本地分支和远程分支：`git branch -a`

   - 创建新分支：`git branch 分支名`
   - 删除分支：`git branch -d 分支名`

2. 切换分支: `git checkout 分支名`

3. 推送至远程仓库分支：`git push [shortName] [name]`

4. 合并分支:：`git merge 分支名`

### 7、标签操作

> Git中的标签，指的是某个分支某个特定时间点的状态。通过标签，可以很方便的切换到标记时的状态。
>
> 比较有代表性的是人们会使用这个功能来标记发布结点（v1.0、v1.2等）

**常用命令**

- `git tag`：列出已有的标签
- `git tag [name]`：创建标签（创建标签时就记录当前分支下的版本信息）
- `git push [shortName] [name]`：将标签推送至远程仓库
- `git checkout -b [branch] [name]`：检出标签（需要新建一个分支branch来指向某个标签）

### 8、IDEA集成Git

**IDEA中配置Git**

1. File ---- Settings
2. Version Control ---- Git ---- 指定git.exe存放目录
3. 点击Test测试

**版本切换**

- Reset Current Branch to Here...：会抛弃原来的提交记录
- Revert Commit：需要进行版本冲突处理，历史记录还保留提交记录

**远程仓库操作**

- 本地推送到远程
- 远程克隆到本地