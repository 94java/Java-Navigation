<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/java-navigation/md/spring/framework.html"><meta property="og:site_name" content="Java-Navigation"><meta property="og:title" content="SpringFramework"><meta property="og:description" content="一、简介 1、框架 框架源自于建筑学，隶属于土木工程，后发展到软件工程领域 软件工程框架：经过验证的，具有一定功能的，半成品软件经过验证; 具有一定功能; 半成品; 框架的作用提高开发效率; 增强可重用性; 提供编写规范; 节约维护成本; 解耦底层实现原理; 2、概念与体系结构 Spring是分层的JavaSE/EE应用 full-..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-12-12T04:19:54.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-12-12T04:19:54.000Z"><title>SpringFramework | Java-Navigation</title><meta name="description" content="一、简介 1、框架 框架源自于建筑学，隶属于土木工程，后发展到软件工程领域 软件工程框架：经过验证的，具有一定功能的，半成品软件经过验证; 具有一定功能; 半成品; 框架的作用提高开发效率; 增强可重用性; 提供编写规范; 节约维护成本; 解耦底层实现原理; 2、概念与体系结构 Spring是分层的JavaSE/EE应用 full-...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/java-navigation/assets/style.a08d2a71.css" as="style" /><link rel="stylesheet" href="/java-navigation/assets/style.a08d2a71.css" />
    <link rel="modulepreload" href="/java-navigation/assets/app.a902b09b.js"><link rel="modulepreload" href="/java-navigation/assets/framework.308787e7.js"><link rel="modulepreload" href="/java-navigation/assets/framework.html.1ca496a3.js"><link rel="modulepreload" href="/java-navigation/assets/framework.html.324de686.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/java-navigation/" class="brand"><img class="logo" src="/java-navigation/logo.svg" alt="Java-Navigation"><!----><span class="site-name hide-in-pad">Java-Navigation</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/java-navigation/md/quick_nav.html" class="nav-link" aria-label="导航"><span class="icon iconfont icon-discover"></span>导航<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title"><span class="icon iconfont icon-java"></span>Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-navigation/md/java/basic.html" class="nav-link" aria-label="基础"><!---->基础<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/collection.html" class="nav-link" aria-label="容器"><!---->容器<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/concurrency.html" class="nav-link" aria-label="并发"><!---->并发<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/io.html" class="nav-link" aria-label="IO"><!---->IO<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/jvm.html" class="nav-link" aria-label="JVM"><!---->JVM<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/new.html" class="nav-link" aria-label="新特性"><!---->新特性<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/java/javaweb.html" class="nav-link" aria-label="JavaWEB"><!---->JavaWEB<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="计算机基础"><span class="title"><span class="icon iconfont icon-study"></span>计算机基础</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-navigation/common//network" class="nav-link" aria-label="计算机网络"><!---->计算机网络<!----></a></li><li class="dropdown-item"><a href="/java-navigation/common//composition" class="nav-link" aria-label="计算机组成原理"><!---->计算机组成原理<!----></a></li><li class="dropdown-item"><a href="/java-navigation/common//os" class="nav-link" aria-label="操作系统"><!---->操作系统<!----></a></li><li class="dropdown-item"><a href="/java-navigation/common//structure" class="nav-link" aria-label="数据结构"><!---->数据结构<!----></a></li><li class="dropdown-item"><a href="/java-navigation/common//algorithm" class="nav-link" aria-label="算法"><!---->算法<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring"><span class="title"><span class="icon iconfont icon-emmet"></span>Spring</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html" class="router-link-active router-link-exact-active nav-link active" aria-label="SpringFramework"><!---->SpringFramework<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/spring/mvc.html" class="nav-link" aria-label="SpringMVC"><!---->SpringMVC<!----></a></li><li class="dropdown-item"><a href="/java-navigation/md/spring/boot.html" class="nav-link" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="数据库"><span class="title"><span class="icon iconfont icon-mysql"></span>数据库</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>基础知识</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="数据库原理"><!---->数据库原理<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="SQL语法"><!---->SQL语法<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>SQL数据库</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="MySQL"><!---->MySQL<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NoSQL数据库</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Redis"><!---->Redis<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="MongoDB"><!---->MongoDB<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="ElasticSearch"><!---->ElasticSearch<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="框架|中间件"><span class="title"><span class="icon iconfont icon-repair"></span>框架|中间件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>常用框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="MyBatis"><!---->MyBatis<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="MyBatis-Plus"><!---->MyBatis-Plus<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Dubbo"><!---->Dubbo<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>中间件</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Zookeeper"><!---->Zookeeper<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="RabbitMQ"><!---->RabbitMQ<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="工具|部署"><span class="title"><span class="icon iconfont icon-relation"></span>工具|部署</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>部署</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Linux"><!---->Linux<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Docker"><!---->Docker<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>工具</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Maven"><!---->Maven<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Git"><!---->Git<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Web 容器</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Tomcat"><!---->Tomcat<!----></a></li><li class="dropdown-subitem"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="Nginx"><!---->Nginx<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="前端"><span class="title"><span class="icon iconfont icon-leaf"></span>前端</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="..."><!---->...<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="架构"><span class="title"><span class="icon iconfont icon-material"></span>架构</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="..."><!---->...<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="风格|规范"><span class="title"><span class="icon iconfont icon-note"></span>风格|规范</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-navigation/zh/guide//" class="nav-link" aria-label="..."><!---->...<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/java-navigation/zh/guide/README.md" class="nav-link" aria-label="面试"><span class="icon iconfont icon-editor"></span>面试<!----></a></div><div class="nav-item hide-in-mobile"><a href="/java-navigation/zh/guide/README.md" class="nav-link" aria-label="项目"><span class="icon iconfont icon-creative"></span>项目<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/HelloCode66/Java-Navigation" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-guide"></span><span class="title">Spring</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/java-navigation/md/spring/outline.html" class="nav-link sidebar-link sidebar-page" aria-label="大纲"><!---->大纲<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/java-navigation/md/spring/framework.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="SpringFramework"><!---->SpringFramework<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#一、简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="一、简介"><!---->一、简介<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、框架" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、框架"><!---->1、框架<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、概念与体系结构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、概念与体系结构"><!---->2、概念与体系结构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、发展史与优势" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、发展史与优势"><!---->3、发展史与优势<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#二、ioc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="二、IoC"><!---->二、IoC<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、简介"><!---->1、简介<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、入门案例" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、入门案例"><!---->2、入门案例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、ioc配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、IOC配置"><!---->3、IOC配置<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#三、常用注解" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="三、常用注解"><!---->三、常用注解<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、基础注解" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、基础注解"><!---->1、基础注解<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、第三方资源" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、第三方资源"><!---->2、第三方资源<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、属性注入" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、属性注入"><!---->3、属性注入<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、peoperties文件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4、peoperties文件"><!---->4、peoperties文件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、注解驱动" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5、注解驱动"><!---->5、注解驱动<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_6、第三方bean配置与管理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6、第三方bean配置与管理"><!---->6、第三方bean配置与管理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_7、bean加载控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7、bean加载控制"><!---->7、bean加载控制<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#四、整合第三方技术" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="四、整合第三方技术"><!---->四、整合第三方技术<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、整合mybatis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、整合MyBatis"><!---->1、整合MyBatis<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、注解整合junit" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、注解整合Junit"><!---->2、注解整合Junit<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#五、ioc底层核心原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="五、IOC底层核心原理"><!---->五、IOC底层核心原理<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、核心接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、核心接口"><!---->1、核心接口<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、组件扫描过滤器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、组件扫描过滤器"><!---->2、组件扫描过滤器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、自定义导入器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、自定义导入器"><!---->3、自定义导入器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、自定义注册器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4、自定义注册器"><!---->4、自定义注册器<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、bean初始化过程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5、bean初始化过程"><!---->5、bean初始化过程<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#六、aop配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="六、AOP配置"><!---->六、AOP配置<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、简介-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、简介"><!---->1、简介<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、入门案例-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、入门案例"><!---->2、入门案例<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、xml配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、XML配置"><!---->3、XML配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、注解配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4、注解配置"><!---->4、注解配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、综合案例" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5、综合案例"><!---->5、综合案例<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#七、aop底层原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="七、AOP底层原理"><!---->七、AOP底层原理<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、静态代理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、静态代理"><!---->1、静态代理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、jdkproxy动态代理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、JDKProxy动态代理"><!---->2、JDKProxy动态代理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、cglib动态代理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、Cglib动态代理"><!---->3、Cglib动态代理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、织入时机" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4、织入时机"><!---->4、织入时机<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#八、事务管理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="八、事务管理"><!---->八、事务管理<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、基础概念" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、基础概念"><!---->1、基础概念<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、spring核心事务对象" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、Spring核心事务对象"><!---->2、Spring核心事务对象<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、案例介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、案例介绍"><!---->3、案例介绍<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、编程式事务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4、编程式事务"><!---->4、编程式事务<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、声明式事务" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5、声明式事务"><!---->5、声明式事务<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#九、模板对象" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="九、模板对象"><!---->九、模板对象<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、jdbctemplate" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1、JdbcTemplate"><!---->1、JdbcTemplate<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、redistemplate" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2、RedisTemplate"><!---->2、RedisTemplate<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、设计模式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3、设计模式"><!---->3、设计模式<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/java-navigation/md/spring/mvc.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringMVC"><!---->SpringMVC<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-navigation/md/spring/boot.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringBoot"><!---->SpringBoot<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-navigation/md/spring/interview.html" class="nav-link sidebar-link sidebar-page" aria-label="面试宝典"><!---->面试宝典<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-navigation/md/spring/resource.html" class="nav-link sidebar-link sidebar-page" aria-label="学习资料"><!---->学习资料<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->SpringFramework</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://book.hellocode.top" target="_blank" rel="noopener noreferrer">HelloCode.</a></span><span property="author" content="HelloCode."></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-12-12T04:19:54.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="category-item category1" role>Spring</span><meta property="articleSection" content="Spring"></span><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 49 分钟</span><meta property="timeRequired" content="PT49M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#一、简介" class="router-link-active router-link-exact-active toc-link level2">一、简介</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、框架" class="router-link-active router-link-exact-active toc-link level3">1、框架</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、概念与体系结构" class="router-link-active router-link-exact-active toc-link level3">2、概念与体系结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、发展史与优势" class="router-link-active router-link-exact-active toc-link level3">3、发展史与优势</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#二、ioc" class="router-link-active router-link-exact-active toc-link level2">二、IoC</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、简介" class="router-link-active router-link-exact-active toc-link level3">1、简介</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、入门案例" class="router-link-active router-link-exact-active toc-link level3">2、入门案例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、ioc配置" class="router-link-active router-link-exact-active toc-link level3">3、IOC配置</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#三、常用注解" class="router-link-active router-link-exact-active toc-link level2">三、常用注解</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、基础注解" class="router-link-active router-link-exact-active toc-link level3">1、基础注解</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、第三方资源" class="router-link-active router-link-exact-active toc-link level3">2、第三方资源</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、属性注入" class="router-link-active router-link-exact-active toc-link level3">3、属性注入</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、peoperties文件" class="router-link-active router-link-exact-active toc-link level3">4、peoperties文件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、注解驱动" class="router-link-active router-link-exact-active toc-link level3">5、注解驱动</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_6、第三方bean配置与管理" class="router-link-active router-link-exact-active toc-link level3">6、第三方bean配置与管理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_7、bean加载控制" class="router-link-active router-link-exact-active toc-link level3">7、bean加载控制</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#四、整合第三方技术" class="router-link-active router-link-exact-active toc-link level2">四、整合第三方技术</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、整合mybatis" class="router-link-active router-link-exact-active toc-link level3">1、整合MyBatis</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、注解整合junit" class="router-link-active router-link-exact-active toc-link level3">2、注解整合Junit</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#五、ioc底层核心原理" class="router-link-active router-link-exact-active toc-link level2">五、IOC底层核心原理</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、核心接口" class="router-link-active router-link-exact-active toc-link level3">1、核心接口</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、组件扫描过滤器" class="router-link-active router-link-exact-active toc-link level3">2、组件扫描过滤器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、自定义导入器" class="router-link-active router-link-exact-active toc-link level3">3、自定义导入器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、自定义注册器" class="router-link-active router-link-exact-active toc-link level3">4、自定义注册器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、bean初始化过程" class="router-link-active router-link-exact-active toc-link level3">5、bean初始化过程</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#六、aop配置" class="router-link-active router-link-exact-active toc-link level2">六、AOP配置</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、简介-1" class="router-link-active router-link-exact-active toc-link level3">1、简介</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、入门案例-1" class="router-link-active router-link-exact-active toc-link level3">2、入门案例</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、xml配置" class="router-link-active router-link-exact-active toc-link level3">3、XML配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、注解配置" class="router-link-active router-link-exact-active toc-link level3">4、注解配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、综合案例" class="router-link-active router-link-exact-active toc-link level3">5、综合案例</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#七、aop底层原理" class="router-link-active router-link-exact-active toc-link level2">七、AOP底层原理</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、静态代理" class="router-link-active router-link-exact-active toc-link level3">1、静态代理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、jdkproxy动态代理" class="router-link-active router-link-exact-active toc-link level3">2、JDKProxy动态代理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、cglib动态代理" class="router-link-active router-link-exact-active toc-link level3">3、Cglib动态代理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、织入时机" class="router-link-active router-link-exact-active toc-link level3">4、织入时机</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#八、事务管理" class="router-link-active router-link-exact-active toc-link level2">八、事务管理</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、基础概念" class="router-link-active router-link-exact-active toc-link level3">1、基础概念</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、spring核心事务对象" class="router-link-active router-link-exact-active toc-link level3">2、Spring核心事务对象</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、案例介绍" class="router-link-active router-link-exact-active toc-link level3">3、案例介绍</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_4、编程式事务" class="router-link-active router-link-exact-active toc-link level3">4、编程式事务</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_5、声明式事务" class="router-link-active router-link-exact-active toc-link level3">5、声明式事务</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#九、模板对象" class="router-link-active router-link-exact-active toc-link level2">九、模板对象</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_1、jdbctemplate" class="router-link-active router-link-exact-active toc-link level3">1、JdbcTemplate</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_2、redistemplate" class="router-link-active router-link-exact-active toc-link level3">2、RedisTemplate</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-navigation/md/spring/framework.html#_3、设计模式" class="router-link-active router-link-exact-active toc-link level3">3、设计模式</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="springframework" tabindex="-1"><a class="header-anchor" href="#springframework" aria-hidden="true">#</a> SpringFramework</h1><h2 id="一、简介" tabindex="-1"><a class="header-anchor" href="#一、简介" aria-hidden="true">#</a> 一、简介</h2><h3 id="_1、框架" tabindex="-1"><a class="header-anchor" href="#_1、框架" aria-hidden="true">#</a> 1、框架</h3><blockquote><p>框架源自于建筑学，隶属于土木工程，后发展到软件工程领域</p></blockquote><p>软件工程框架：经过验证的，具有一定功能的，半成品软件</p><ul><li>经过验证</li><li>具有一定功能</li><li>半成品</li></ul><p><strong>框架的作用</strong></p><ul><li>提高开发效率</li><li>增强可重用性</li><li>提供编写规范</li><li>节约维护成本</li><li>解耦底层实现原理</li></ul><h3 id="_2、概念与体系结构" tabindex="-1"><a class="header-anchor" href="#_2、概念与体系结构" aria-hidden="true">#</a> 2、概念与体系结构</h3><blockquote><p>Spring是分层的JavaSE/EE应用 full-stack轻量级开源框架</p></blockquote><ul><li><p>分层：可以把Spring中的一部分单独拿出来使用，也可以整体一起使用（更加高效）</p></li><li><p>full-stack：Spring提供一站式解决方案</p></li></ul><p><strong>体系结构</strong></p><figure><img src="http://images.hellocode.top/gLwS4A8toIq7MYd.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>底层是核心容器</strong></p><ul><li>Beans</li><li>Core</li><li>Context</li><li>SpringEl表达式</li></ul><p><strong>中间层技术</strong></p><ul><li>AOP</li><li>Aspects</li></ul><p><strong>应用层技术</strong></p><ul><li>数据访问与数据集成</li><li>Web集成</li><li>Web实现</li></ul><p><strong>基于Test测试</strong></p><blockquote><p>Spring不是只有Java的，其他语言也有Spring</p></blockquote><h3 id="_3、发展史与优势" tabindex="-1"><a class="header-anchor" href="#_3、发展史与优势" aria-hidden="true">#</a> 3、发展史与优势</h3><figure><img src="http://images.hellocode.top/QjT97YgryRaWJ3G.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>优势</strong></p><ul><li>方便解耦，简化开发</li><li>方便集成各种优秀框架</li><li>方便程序的测试</li><li>AOP编程的支持</li><li>声明事务的支持</li><li>降低JavaEE API的使用难度</li><li>Java源码是经典学习范例</li></ul><h2 id="二、ioc" tabindex="-1"><a class="header-anchor" href="#二、ioc" aria-hidden="true">#</a> 二、IoC</h2><h3 id="_1、简介" tabindex="-1"><a class="header-anchor" href="#_1、简介" aria-hidden="true">#</a> 1、简介</h3><p><strong>耦合与内聚</strong></p><ul><li>耦合（Coupling）：代码书写过程中所使用技术的结合紧密度，用于衡量软件中各个模块之间的互联程度</li><li>内聚（Cohesion）：代码书写过程中单个模块内部各组成部分间的联系，用于衡量软件中各个功能模块内部的功能联系</li></ul><p>程序书写的目标：高内聚，低耦合</p><blockquote><p>就是同一个模块内各个元素之间要高度紧密，但是各个模块之间的相互依存度却不要那么紧密</p></blockquote><p><strong>工厂模式发展史</strong></p><figure><img src="http://images.hellocode.top/Zb7ho431PsJlLmC.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="http://images.hellocode.top/6vnzJQy1UVaDkgO.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="http://images.hellocode.top/hgBNwZRVvKCPXcr.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>如果类耦合的话，修改后需要重新编译、打包、发布，但是如果是和配置文件耦合，不需要做这些事情</p></blockquote><p><strong>IoC</strong></p><ul><li>IoC（Inversion Of Control）：控制反转，Spring反向控制应用程序所需要使用的外部资源</li><li>Spring控制的资源全部放置在Spring容器中，该容器称为IoC容器</li></ul><figure><img src="http://images.hellocode.top/VfN1KoDqbEuF4xp.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2、入门案例" tabindex="-1"><a class="header-anchor" href="#_2、入门案例" aria-hidden="true">#</a> 2、入门案例</h3><p><strong>案例环境说明</strong></p><p>模拟三层架构中表现层调用业务层功能</p><ul><li>表现层：UserApp模拟UserServlet（使用main方法模拟）</li><li>业务层：UserService</li></ul><p><strong>步骤</strong></p><ol><li><p>导入spring坐标（5.1.9.release）</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>编写业务层与表现层（模拟）接口与实现类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>建立spring配置文件(<code>applicationContext.xml</code>)</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--1. 创建spring控制的资源--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.service.impl.UserServiceImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>配置所需资源（Service）为spring控制的资源</p></li><li><p>表现层（App）通过spring获取资源（Service实例）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2. 加载配置文件</span>
    <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3. 获取资源</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_3、ioc配置" tabindex="-1"><a class="header-anchor" href="#_3、ioc配置" aria-hidden="true">#</a> 3、IOC配置</h3><h4 id="_3-1-bean" tabindex="-1"><a class="header-anchor" href="#_3-1-bean" aria-hidden="true">#</a> 3.1. bean</h4><ul><li><p>名称：bean</p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：beans标签</p></li><li><p>作用：定义spring中的资源，受此标签定义的资源将受到spring控制</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本属性</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanName1,beanName2,...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ClassName<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>id：bean的名称，通过id获取bean</li><li>class：bean的类型</li><li>name：bean的名称，可以通过name值获取bean，用于多人配合时给bean起别名</li></ul><p><strong>scope属性</strong></p><ul><li><p>名称：scope</p></li><li><p>类型：属性</p></li><li><p>归属：bean标签</p></li><li><p>作用：定义bean的作用范围</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>singleton<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>取值</p><ul><li>singleton：设定创建出的对象保存在spring容器中，是一个单例的对象（默认）</li><li>prototype：设定创建出的对象保存在spring容器中，是一个非单例的对象</li><li>request、session、application、websocket：设定创建出的对象放置在web容器对应的位置</li></ul><blockquote><p>单例模式：通过单例模式的方法创建的类在当前进程中只有一个实例</p></blockquote><blockquote><p>单例和非单例模式创建对象的时机不同：单例模式是在加载时创建，非单例是在使用时创建</p></blockquote><p><strong>bean生命周期</strong></p><ul><li><p>名称：init-method，destroy-method</p></li><li><p>类型：属性</p></li><li><p>归属：bean标签</p></li><li><p>作用：定义bean对象在初始化或销毁时完成的工作</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>init<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>destroy<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>取值：bean对应的类中对应的具体方法名</p><p>注意事项</p><ul><li>当<code>scope=&quot;singleton&quot;</code>时，spring容器中有且仅有一个对象，init方法在创建容器时仅执行一次</li><li>当<code>scope=&quot;prototype&quot;</code>时，spring容器要创建同一类型的多个对象，init方法在每个对象创建时均执行一次</li><li>当<code>scope=&quot;singleton&quot;</code>时，关闭容器会导致bean实例的销毁，调用destroy方法一次</li><li>当<code>scope=&quot;prototype&quot;</code>时，对象的销毁由垃圾回收机制gc()控制，destroy方法将不会被执行</li></ul><blockquote><p>当scope为非单例模式时，销毁不归spring管理</p></blockquote><p><strong>静态工厂与实例工厂创建bean</strong>（了解）</p><ul><li><p>名称：factory-bean，factory-method</p></li><li><p>类型：属性</p></li><li><p>归属：bean标签</p></li><li><p>作用：定义bean对象创建方式，使用实例工厂的形式创建bean，兼容早期遗留系统的升级工作</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">factory-bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>factoryBeanId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">factory-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>factoryMethodName<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>取值：工厂bean中用于获取对象的实例方法名</p><p>注意事项</p><ul><li>使用实例工厂创建bean首先需要将实例工厂配置bean，交由spring进行管理</li><li>factory-bean是实例工厂的beanId</li></ul><h4 id="_3-2-di" tabindex="-1"><a class="header-anchor" href="#_3-2-di" aria-hidden="true">#</a> 3.2. DI</h4><blockquote><p>DI（Dependency Injection）：依赖注入，应用程序运行依赖的资源由Spring为其提供，资源进入应用程序的方式称为注入</p></blockquote><figure><img src="http://images.hellocode.top/My3rngxRkZX2qYp.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>IoC与DI是同一件事站在不同的角度看待问题</li></ul><p><strong>set注入</strong>（主流）</p><ul><li><p>名称：property</p></li><li><p>类型：标签</p></li><li><p>归属：bean标签</p></li><li><p>作用：使用set方法的形式为bean提供资源</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本属性</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>propertyName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>propertyValue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanId<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>name：对应bean中的属性名，要求该属性必须提供可访问的set方法（严格规范此名是set方法对应的名称）</p></li><li><p>value：设定非引用类型属性对应的值，不能与ref同时使用</p></li><li><p>ref：设定引用类型属性对应bean的id，不能与value同时使用</p></li><li><p>注意：一个bean可以有多个property标签</p></li></ul><blockquote><p>字符串当作非引用类型处理</p></blockquote><p><strong>构造器注入</strong>（了解）</p><ul><li><p>名称：constructor-arg</p></li><li><p>类型：标签</p></li><li><p>归属：bean标签</p></li><li><p>作用：使用构造方法的形式为bean提供资源，兼容早期遗留系统的升级工作</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本属性</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>argsName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>argsValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>name：对应bean中的构造方法所携带的参数名</li><li>value：设定非引用类型构造方法参数对应的值，不能与ref同时使用</li><li>ref：设定引用类型属性对应bean的id，不能与value同时使用</li></ul><p>其他属性</p><ul><li>type：设定构造方法参数的类型，用于按类型匹配参数或进行类型校验</li><li>index：设定构造方法参数的位置，用于按位置匹配参数，参数index值从0开始计数</li></ul><p>注意：一个bean可以有多个constructor-arg标签</p><p><strong>集合注入</strong></p><ul><li><p>名称：array，list，set，map，props</p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：property标签 或 constructor-arg标签</p></li><li><p>作用：注入集合数据类型属性</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hellocode<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>666<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.service.UserService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myProps<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myArray<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>array</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hellocode<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>666<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.service.UserService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>array</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mySet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hellocode<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>666<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.service.UserService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hellocode<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fame<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>666<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ref</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>applyService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>applyService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>array和list是互通的，二者可以相互注入</p></blockquote><p><strong>使用p命名空间简化配置</strong>（了解）</p><ul><li><p>名称：p:peopertyName，p:peopertyName-ref</p></li><li><p>类型：<em>属性</em></p></li><li><p>归属：bean标签</p></li><li><p>作用：为bean注入属性值</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name"><span class="token namespace">p:</span>propertyName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>propertyValue<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">p:</span>propertyName-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanId<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意：使用p命令空间需要先开启spring对p命令空间的支持，在beans标签中添加对应空间支持</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>p</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/p<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</code></p></blockquote><p><strong>SpEL</strong>（了解）</p><ul><li><p>Spring提供了对EL表达式的支持，统一属性注入格式</p></li><li><p>类型：<em>属性值</em></p></li><li><p>归属：value属性</p></li><li><p>作用：为bean注入属性值</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>EL<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：所有属性不区分是否引用类型，统一使用value赋值</p><p>所有格式统一使用 <code>value=&quot;******&quot;</code></p><ul><li>常量：<code>#{10}</code> <code>#{3.14}</code> <code>#{2e5}</code> <code>#{&quot;hellocode&quot;}</code></li><li>引用bean：<code>#{beanId}</code></li><li>引用bean属性：<code>#{beanId.propertyName}</code></li><li>引用bean方法：<code>beanId.methodName().method2()</code></li><li>引用静态方法：<code>T(java.lang.Math).PI</code></li><li>运算符支持：<code>#{3 lt 4 == 4 ge 3}</code></li><li>正则表达式支持：<code>#{user.name.matches &#39;[a-z]{6,}&#39;}</code></li><li>集合支持：<code>#{likes[3]}</code></li></ul><h4 id="_3-3-properties文件" tabindex="-1"><a class="header-anchor" href="#_3-3-properties文件" aria-hidden="true">#</a> 3.3. properties文件</h4><blockquote><p>Spring提供了读取外部properties文件的机制，使用读取到的数据为bean的属性赋值</p></blockquote><p><strong>操作步骤</strong></p><ol><li><p>准备外部properties文件</p></li><li><p>开启context命名空间支持</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>加载指定的properties文件</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:filename.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>使用加载的数据</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>propertyName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${propertiesName}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><ul><li>注意：如果需要加载所有的properties文件，可以使用<code>*.properties</code>表示加载所有的properties文件</li><li>注意：读取数据使用<code>${propertiesName}</code>格式进行，其中propertiesName指properties文件中的属性名</li></ul><blockquote><p>在读取username值时，出现的是当前电脑的用户名，是因为context中已经有username属性，为了区分，尽量避免使用username，可以用user代替</p></blockquote><h4 id="_3-4-团队开发" tabindex="-1"><a class="header-anchor" href="#_3-4-团队开发" aria-hidden="true">#</a> 3.4. 团队开发</h4><ul><li><p>名称：import</p></li><li><p>类型：标签</p></li><li><p>归属：beans标签</p></li><li><p>作用：在当前配置文件中导入其他配置文件中的项</p></li></ul><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本属性</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">resources</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>config.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>resources：加载的配置文件名</li></ul><p>Spring容器加载多个配置文件（了解）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;config1.xml&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;config2.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Spring容器中的bean定义冲突问题</p><ul><li>同id的bean，后定义的覆盖先定义的</li><li>导入配置文件可以理解为将导入的配置文件复制粘贴到对应位置</li><li>导入配置文件的顺序与位置不同可能会导致最终程序运行结果不同</li></ul><h4 id="_3-5-applicationcontext" tabindex="-1"><a class="header-anchor" href="#_3-5-applicationcontext" aria-hidden="true">#</a> 3.5. ApplicationContext</h4><figure><img src="http://images.hellocode.top/TCNs3Y7cJKzRpQ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ApplicationContext是一个接口，提供了访问spring容器的API</li><li>ClassPathXmlApplicationContext是一个类，实现了上述功能</li><li>ApplicationContext的顶层接口是BeanFactory</li><li>BeanFactory定义了bean相关的最基本操作</li><li>ApplicationContext在BeanFactory基础上追加了若干新功能</li></ul><p><strong>对比BeanFactory</strong></p><ul><li>BeanFactory创建的bean采用延迟加载形式，使用才创建</li><li>ApplicationContext创建的bean默认采用立即加载形式</li></ul><p><strong>FileSystemXmlApplicationContext</strong></p><ul><li>可以加载文件系统中任意位置的配置文件，而ClassPathXmlApplicationContext只能加载类路径下的配置文件</li></ul><h4 id="_3-6-第三方资源配置" tabindex="-1"><a class="header-anchor" href="#_3-6-第三方资源配置" aria-hidden="true">#</a> 3.6. 第三方资源配置</h4><p>阿里数据源方案Druid</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.alibaba.druid.pool.DruidDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306/spring_db<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hellocode<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、常用注解" tabindex="-1"><a class="header-anchor" href="#三、常用注解" aria-hidden="true">#</a> 三、常用注解</h2><p><strong>什么是注解驱动</strong></p><ul><li>注解驱动是使用注解的形式替代xml配置，将繁杂的spring配置文件从工程中彻底消除掉，简化书写</li></ul><p><em>弊端</em></p><ul><li>为了达成注解驱动的目的，可能会将原先很简单的书写，变得更加繁杂</li><li>XML中配置第三方开发的资源是很方便的，但使用注解驱动无法在第三方开发的资源中进行编辑，因此会增大开发工作量</li></ul><p><strong>启动注解功能</strong></p><ul><li><p>启动注解扫描，加载类中配置的注解项</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>packageName<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p><em>说明</em></p><ul><li>在进行包的扫描时，会对配置的包及其子包中所有文件进行扫描</li><li>扫描过程是以文件夹递归迭代的形式进行的</li><li>扫描过程仅读取合法的Java文件</li><li>扫描时仅读取spring可识别的注解</li><li>扫描结束后会将可识别的有效注解转化为spring对应的资源加入IoC容器</li></ul><p><em>注意</em></p><ul><li>无论是注解格式还是xml配置格式，最终都是将资源加载到IoC容器中，差别仅仅是数据读取方式不同</li><li>从加载效率上来说注解优于xml配置文件</li></ul><h3 id="_1、基础注解" tabindex="-1"><a class="header-anchor" href="#_1、基础注解" aria-hidden="true">#</a> 1、基础注解</h3><p><strong>bean的定义</strong></p><ul><li><p>名称：<code>@Component</code> <code>@Controller</code> <code>@Service</code> <code>@Repository</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：设置该类为spring管理的bean</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li><code>@Controller</code>、<code>@Service</code>、<code>@Repository</code>是<code>@Component</code>的衍生注解，功能同<code>@Component</code></li></ul></li><li><p>相关属性</p><ul><li><code>value</code>（默认）：定义bean的访问id</li></ul></li></ul><p><strong>bean的作用域</strong></p><ul><li><p>名称：<code>@Scope</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：设置该类作为bean对应的scope属性</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Scope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>相关属性</p><ul><li>value（默认）：定义bean的作用域，默认为singleton</li></ul></li></ul><p><strong>生命周期</strong></p><ul><li><p>名称：<code>@PostConstruct</code>、<code>PreDestroy</code></p></li><li><p>类型：<em>方法注解</em></p></li><li><p>位置：方法定义上方</p></li><li><p>作用：设置该类作为bean对应的生命周期方法</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostConstruct</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;init...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_2、第三方资源" tabindex="-1"><a class="header-anchor" href="#_2、第三方资源" aria-hidden="true">#</a> 2、第三方资源</h3><ul><li><p>名称：<code>@Bean</code></p></li><li><p>类型：<em>方法注解</em></p></li><li><p>位置：方法定义上方</p></li><li><p>作用：设置该方法的返回值作为spring管理的bean</p></li></ul><p><strong>范例</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DruidDataSource</span> <span class="token function">createDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>说明</strong></p><ul><li><p>因为第三方bean无法在其源码上进行修改，使用@Bean解决第三方bean的引入问题</p></li><li><p>该注解用于替代xml配置中的静态工厂与实例工厂创建bean，不区分方法是否为静态或非静态</p></li><li><p>@Bean所在的类必须按spring扫描加载，否则该注解无法生效</p></li><li><p>相关属性</p><ul><li>value（默认）：定义bean的访问id</li></ul></li></ul><h3 id="_3、属性注入" tabindex="-1"><a class="header-anchor" href="#_3、属性注入" aria-hidden="true">#</a> 3、属性注入</h3><p><strong>bean的非引用类型属性注入</strong></p><ul><li><p>名称：<code>@Value</code></p></li><li><p>类型：<em>属性注解、方法注解</em></p></li><li><p>位置：属性定义上方、方法定义上方</p></li><li><p>作用：设置对应属性的值或对方法进行传参</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;$(jdbc.username)&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>value值仅支持非引用类型数据，赋值时对方法的所有参数全部赋值</li><li>value值支持读取properties文件中的属性值，通过类属性将properties中数据传入类中</li><li>value值支持spEL</li><li>@value注解如果添加在属性上方，可以省略set方法（set方法的目的是为属性赋值）</li></ul></li><li><p>相关属性</p><ul><li>value（默认）：定义对应的属性值或参数值</li></ul></li></ul><p><strong>bean的引用类型属性注入</strong></p><ul><li><p>名称：<code>@Autowired</code>、<code>@Qualifier</code></p></li><li><p>类型：<em>属性注解、方法注解</em></p></li><li><p>位置：属性定义上方、方法定义上方</p></li><li><p>作用：设置对应属性的对象或对方法进行引用类型传参</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span><span class="token punctuation">(</span>required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>@Autowired默认按类型装配，指定@Qualifier后可以指定自动装配的bean的id</li></ul></li><li><p>相关属性</p><ul><li>required：定义该属性是否允许为null</li></ul></li></ul><hr><ul><li><p>名称：@Primary</p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：设置类对应的bean按类型装配时优先装配</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Primary</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>@Autowired默认按类型装配，当出现相同类型的bean，使用@Primary提高按类型自动装配的优先级，多个@Primary会导致优先级设置无效</li></ul></li></ul><p><strong>了解</strong></p><ul><li>名称：<code>@Inject</code>、<code>@Named</code>、<code>@Resource</code></li><li>说明 <ul><li>@Inject与@Named是JSR330规范中的注解，功能与@Autowired和@Qualifier完全相同，适用于不同架构场景</li><li>@Resource是JSR250规范中的注解，可以简化书写格式</li></ul></li><li>@Resource相关书写 <ul><li>name：设置注入的bean的id</li><li>type：设置注入的bean的类型，接收的参数为Class类型</li></ul></li></ul><h3 id="_4、peoperties文件" tabindex="-1"><a class="header-anchor" href="#_4、peoperties文件" aria-hidden="true">#</a> 4、peoperties文件</h3><ul><li><p>名称：<code>@PropertySource</code></p></li><li><p>类型：<em>类注释</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：加载properties文件中的属性值</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PropertiesSource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;classpath:filename.properties&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${propertiesAttributeName}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> attributeName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>不支持*通配格式，一旦加载，所有spring控制的bean中均可使用对应属性值</li></ul></li><li><p>相关属性</p><ul><li>value（默认）：设置加载的properties文件名</li><li>ignoreResourceNotFound：如果资源未找到，是否忽略，默认为false</li></ul></li></ul><h3 id="_5、注解驱动" tabindex="-1"><a class="header-anchor" href="#_5、注解驱动" aria-hidden="true">#</a> 5、注解驱动</h3><ul><li><p>名称：<code>@Configuration</code>、<code>@ComponentScan</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：设置当前类为spring核心配置加载类</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;scanPackageName&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfigClassName</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>核心配置类用于替换spring核心配置文件，此类可以设置为空，不设置变量与属性</li><li>bean扫描工作使用注解<code>@ComponentScan</code>替代</li></ul></li></ul><h3 id="_6、第三方bean配置与管理" tabindex="-1"><a class="header-anchor" href="#_6、第三方bean配置与管理" aria-hidden="true">#</a> 6、第三方bean配置与管理</h3><ul><li><p>名称：<code>@Import</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：导入第三方bean作为spring控制的资源</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">OtherClassName</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li><code>@Import</code>注解在同一个类上，仅允许添加一次，如果需要导入多个，使用数组的形式进行设定</li><li>在被导入的类中可以继续使用<code>@Import</code>导入其他资源（了解）</li><li><code>@Bean</code>所在的类可以使用导入的形式进入spring容器，无需声明为bean</li></ul></li></ul><h3 id="_7、bean加载控制" tabindex="-1"><a class="header-anchor" href="#_7、bean加载控制" aria-hidden="true">#</a> 7、bean加载控制</h3><p><strong>依赖加载</strong></p><ul><li><p>名称：<code>@DependsOn</code></p></li><li><p>类型：<em>类注解</em>、<em>方法注解</em></p></li><li><p>位置：bean定义的位置（类上或方法上）</p></li><li><p>作用：控制bean的加载顺序，使其在指定bean加载完毕后再加载</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@DependsOn</span><span class="token punctuation">(</span><span class="token string">&quot;beanId&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明</p><ul><li>配置在方法上，使<code>@DependsOn</code>指定的bean优先于<code>@Bean</code>配置的bean进行加载</li><li>配置在类上，使<code>@DependsOn</code>指定的bean优先于当前类中所有<code>@Bean</code>配置的bean进行加载</li><li>配置在类上，使<code>@DependsOn</code>指定的bean优先于<code>@Component</code>等配置的bean进行加载</li></ul></li><li><p>相关属性</p><ul><li>value（默认）：设置当前bean所依赖的bean的id</li></ul></li></ul><hr><ul><li><p>名称：<code>@Order</code></p></li><li><p>类型：<em>配置类注解</em></p></li><li><p>位置：配置类定义的位置（类上）</p></li><li><p>作用：控制配置类的加载顺序</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfigClassName</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><ul><li><p>名称：<code>@Lazy</code></p></li><li><p>类型：<em>类注解</em>、<em>方法注解</em></p></li><li><p>位置：bean定义的位置（类上或方法上）</p></li><li><p>作用：控制bean的加载时机，使其延迟加载</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Lazy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassName</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>依赖加载应用场景</strong></p><ul><li><code>@DependsOn</code><ul><li>微信订阅号，发布消息和订阅消息的加载顺序控制</li><li>双11活动期间，零点前是结算策略A，零点后是结算策略B，策略B操作的数据为促销数据。策略B加载顺序与促销数据的加载顺序</li></ul></li><li><code>@Lazy</code><ul><li>程序灾难出现后对应的应急预案处理是启动容器时加载时机</li></ul></li><li><code>@Order</code><ul><li>多个种类的配置出现后，优先加载系统级的，然后加载业务级的，避免细粒度的加载控制</li></ul></li></ul><h2 id="四、整合第三方技术" tabindex="-1"><a class="header-anchor" href="#四、整合第三方技术" aria-hidden="true">#</a> 四、整合第三方技术</h2><h3 id="_1、整合mybatis" tabindex="-1"><a class="header-anchor" href="#_1、整合mybatis" aria-hidden="true">#</a> 1、整合MyBatis</h3><h4 id="_1-1-xml方式" tabindex="-1"><a class="header-anchor" href="#_1-1-xml方式" aria-hidden="true">#</a> 1.1. xml方式</h4><ol><li><p>导入Spring整合Mybatis坐标</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.46<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>将Mybatis配置成spring管理的bean（<code>sqlSessionFactoryBean</code>）</p><ul><li><p>将原始配置文件中的所有项，转入到当前配置中</p><p>数据源转换</p><p>映射转换</p></li></ul></li><li><p>通过spring加载mybatis的映射配置文件到spring环境中</p></li><li><p>设置类别名</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:*.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!--加载druid资源--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.alibaba.druid.pool.DruidDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.driver}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!--配置service作为spring的bean，注入dao--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>accountService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.service.impl.AccountServiceImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>accountDao<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>accountDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!--spring整合mybatis后控制的创建连接用的对象--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.spring.SqlSessionFactoryBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>typeAliasesPackage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.domain<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!--加载mybatis映射配置的扫描，将其作为spring的bean进行管理--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis.spring.mapper.MapperScannerConfigurer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>basePackage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.dao<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>测试结果</p></li></ol><p>使用spring环境加载业务层bean，执行操作</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ApplicationContext</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AccountService</span> accountService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AccountService</span><span class="token punctuation">)</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;accountService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Account</span> account <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        account<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        account<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        account<span class="token punctuation">.</span><span class="token function">setMoney</span><span class="token punctuation">(</span><span class="token number">888.88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// accountService.save(account);</span>
        accountService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>小结</strong></p><ul><li>需要专用的spring整合mybatis的jar包</li><li>Mybatis核心配置文件消失 <ul><li>环境environment转换成数据源对象</li><li>映射Mapper扫描工作交由spring处理</li><li>类型别名交由spring处理</li></ul></li><li>业务发起使用spring上下文对象获取对应的bean</li></ul><h4 id="_1-2-注解方式" tabindex="-1"><a class="header-anchor" href="#_1-2-注解方式" aria-hidden="true">#</a> 1.2. 注解方式</h4><ul><li>业务类使用注解形式声明bean，属性采用注解注入</li><li>建立独立的配置管理类，分类管理外部资源，根据功能进行分类，并提供对应的方法获取bean</li><li>使用注解形式启动bean扫描，加载所有注解配置的资源（bean）</li><li>使用<code>AnnotationConfigApplicationContext</code>对象加载所有的启动配置类，内部使用导入方式进行关联</li></ul><p><strong>步骤</strong></p><ol><li>修改mybatis外部配置文件格式为注解格式</li><li>业务类使用@Commponent声明bean，使用@Autowired注入对象</li><li>建立配置文件JDBCConfig与MyBatisConfig类，并将其导入到核心配置类SpringConfig</li><li>开启注解扫描</li><li>使用AnnotationConfigApplicationContext对象加载配置项</li></ol><p><em>Dao</em></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月06日 16:33
 */</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountDao</span> <span class="token punctuation">{</span>
    <span class="token comment">// 新增</span>
    <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">&quot;INSERT INTO account(name,money) values(#{name},#{money})&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 删除</span>
    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">&quot;DELETE FROM account WHERE id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 修改</span>
    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">&quot;UPDATE account SET name=#{name},money=#{money} where id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 查询</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM account&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM account WHERE id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>Service</em></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月06日 16:35
 */</span>
<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">&quot;accountService&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>

    <span class="token comment">//    public void setAccountDao(AccountDao accountDao) {</span>
    <span class="token comment">//        this.accountDao = accountDao;</span>
    <span class="token comment">//    }</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        accountDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        accountDao<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        accountDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Account</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> accountDao<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> accountDao<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>config</em></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月09日 14:24
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:jdbc.properties&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">JDBCConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token class-name">MyBatisConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfig</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月09日 14:26
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.driver}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> driver<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.url}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.username}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${jdbc.password}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;dataSource&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">DruidDataSource</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ds<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ds<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ds<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ds<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ds<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月09日 14:34
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactoryBean</span> <span class="token function">getSqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Autowired</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">SqlSessionFactoryBean</span> ssfb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssfb<span class="token punctuation">.</span><span class="token function">setTypeAliasesPackage</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode.domain&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssfb<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ssfb<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MapperScannerConfigurer</span> <span class="token function">getMapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">MapperScannerConfigurer</span> msc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapperScannerConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        msc<span class="token punctuation">.</span><span class="token function">setBasePackage</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode.dao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> msc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、注解整合junit" tabindex="-1"><a class="header-anchor" href="#_2、注解整合junit" aria-hidden="true">#</a> 2、注解整合Junit</h3><ol><li>Spring接管Junit的运行权，使用Spring专用的Junit类加载器</li><li>为Junit测试用例设定对应的Spring容器</li></ol><p><strong>注意</strong></p><ul><li>从Spring5.0之后，要求Junit的版本必须是4.12及以上</li><li>Junit仅用于单元测试，不能将Junit的测试类配置成Spring的bean，否则该配置将会被打包进入工程中</li></ul><p><strong>导入Spring整合Junit坐标</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Spring整合junit测试用例注解格式</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJunit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">SpringConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceTest</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>测试代码</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年06月09日 14:51
 */</span>
<span class="token comment">// 设定spring专用的类加载器</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token comment">// 设定加载的Spring上下文对应的配置</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">SpringConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFindById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Account</span> ac <span class="token operator">=</span> accountService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>ac<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、ioc底层核心原理" tabindex="-1"><a class="header-anchor" href="#五、ioc底层核心原理" aria-hidden="true">#</a> 五、IOC底层核心原理</h2><blockquote><p>xml解析、工厂模式、反射</p></blockquote><ul><li>解析xml文件，获取配置内容</li><li>通过反射，以工厂模式将对应的bean创建出来并返回</li></ul><h3 id="_1、核心接口" tabindex="-1"><a class="header-anchor" href="#_1、核心接口" aria-hidden="true">#</a> 1、核心接口</h3><figure><img src="http://images.hellocode.top/T9flr7QGtPpJkMX.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>BeanFactory：提供Bean的基本操作</strong></p><ul><li>bean获取 <ul><li>按名称获取</li><li>按类型获取</li></ul></li><li>bean供应商</li><li>bean基本信息 <ul><li>是否存在</li><li>是否单例</li><li>类型获取</li><li>类型检测（类型是否匹配）</li><li>别名获取</li></ul></li></ul><p><strong>HierarchicalBeanFactory：提供bean分层结构，提出父子容器概念</strong></p><ul><li>获取本地bean</li></ul><p><strong>AutowireCapableBeanFactory：提供bean自动装配功能</strong></p><ul><li>bean创建</li><li>自动装配 <ul><li>装配方式</li><li>前置动作</li><li>后置动作</li></ul></li></ul><p><strong>ListableBeanFactory：提供容器内部遍历搜索bean的功能</strong></p><ul><li>容器中bean信息 <ul><li>bean存在性</li><li>bean的数量</li><li>bean的类型</li></ul></li><li>bean相关信息获取 <ul><li>由类型获取bean的名称</li><li>由注解获取bean的名称</li></ul></li><li>bean信息获取 <ul><li>bean的注解</li><li>bean的定义名称</li></ul></li></ul><h3 id="_2、组件扫描过滤器" tabindex="-1"><a class="header-anchor" href="#_2、组件扫描过滤器" aria-hidden="true">#</a> 2、组件扫描过滤器</h3><figure><img src="http://images.hellocode.top/xOS3ItBQJP8Zcbq.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>开发过程中，需要根据需求加载必要的bean，排除指定bean</p></blockquote><p><strong>设定组件扫描加载过滤器</strong></p><ul><li><p>名称：<code>@ComponentScan</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：类定义上方</p></li><li><p>作用：设置spring配置加载类扫描规则</p></li></ul><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>
	value <span class="token operator">=</span> <span class="token string">&quot;top.hellocode&quot;</span>			<span class="token comment">// 设置基础扫描路径</span>
    excludeFilters <span class="token operator">=</span> 				<span class="token comment">// 设置过滤规则，当前为排除过滤</span>
    	<span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>		<span class="token comment">// 设置过滤器</span>
        	type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span>		<span class="token comment">// 设置过滤方式为按照注解进行过滤</span>
            classes <span class="token operator">=</span> <span class="token class-name">Repository</span><span class="token punctuation">.</span><span class="token keyword">class</span>			<span class="token comment">// 设置具体的过滤项，过滤所有@Repository修饰的bean</span>
        <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>includeFilters：设置包含性过滤器</li><li>excludeFilters：设置排除性过滤器</li><li>type：设置过滤器类型</li></ul><p><strong>自定义组件过滤器</strong></p><ul><li><p>名称：TypeFilter</p></li><li><p>类型：<em>接口</em></p></li><li><p>作用：自定义类型过滤器</p></li></ul><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTypeFilter</span> <span class="token keyword">implements</span> <span class="token class-name">TypeFilter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token class-name">MetadataReader</span> metadataReader<span class="token punctuation">,</span> <span class="token class-name">MetadataReaderFactory</span> metadataReaderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// 加载的类满足要求，匹配成功</span>
        <span class="token class-name">ClassMetadata</span> classMetadata <span class="token operator">=</span> metadataReader<span class="token punctuation">.</span><span class="token function">getClassMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> className <span class="token operator">=</span> classMetadata<span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode.service.impl.UserServiceImpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、自定义导入器" tabindex="-1"><a class="header-anchor" href="#_3、自定义导入器" aria-hidden="true">#</a> 3、自定义导入器</h3><blockquote><p>bean只有通过配置才可以进入spring容器，被spring加载并控制</p></blockquote><p><strong>配置bean的方式如下</strong></p><ul><li>XML文件中使用<code>&lt;bean/&gt;</code>标签配置</li><li>使用<code>@Component</code>及衍生注解配置</li></ul><blockquote><p>企业开发中，通常需要配置大量的bean，需要一种快速高效配置大量bean的方式，就需要用到导入器</p></blockquote><p><strong>自定义导入器</strong></p><ul><li><p>名称：ImportSelector</p></li><li><p>类型：<em>接口</em></p></li><li><p>作用：自定义bean导入器</p></li></ul><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyImportSelector</span> <span class="token keyword">implements</span> <span class="token class-name">ImportSelector</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> icm<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode.service.impl.UserServiceImpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">MyImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfig</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4、自定义注册器" tabindex="-1"><a class="header-anchor" href="#_4、自定义注册器" aria-hidden="true">#</a> 4、自定义注册器</h3><ul><li><p>名称：ImportBeanDefinitionRegistrar</p></li><li><p>类型：<em>接口</em></p></li><li><p>作用：自定义bean定义注册器</p></li></ul><p><strong>范例</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyImportRegistrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> beanDefinitionRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ClassPathBeanDefinitionScanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathBeanDefinitionScanner</span><span class="token punctuation">(</span>beanDefinitionRegistry<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        scanner<span class="token punctuation">.</span><span class="token function">addIncludeFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TypeFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token class-name">MetadataReader</span> metadataReader<span class="token punctuation">,</span> <span class="token class-name">MetadataReaderFactory</span> metadataReaderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        scanner<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用：<code>@Import(MyImportRegistrar.class)</code></li></ul><h3 id="_5、bean初始化过程" tabindex="-1"><a class="header-anchor" href="#_5、bean初始化过程" aria-hidden="true">#</a> 5、bean初始化过程</h3><figure><img src="http://images.hellocode.top/4WOLroqtFAVUjZM.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>BeanFactoryPostProcessor</strong></p><ul><li>作用：定义了在bean工厂对象创建后，bean对象创建前执行的动作，用于对工厂进行创建后业务处理</li><li>运行时机：当前操作用于对工厂进行处理，仅运行一次</li></ul><p><strong>BeanPostProcessor</strong></p><ul><li>作用：定义了所有bean初始化前后进行的统一动作，用于对bean进行创建前业务处理与创建后业务处理</li><li>运行时机：当前操作伴随着每个bean的创建过程，每次创建bean均运行该操作</li></ul><p><strong>InitializingBean</strong></p><ul><li><p>作用：定义了每个bean的初始化前进行的动作，属于非统一性动作，用于对bean进行创建前业务处理</p></li><li><p>运行时机：当前操作伴随着任意一个bean的创建过程，保障其个性化业务处理</p></li></ul><blockquote><p>注意：上述操作均需要被spring容器加载方可运行（@Import）</p><p>@Import只能有一个，需要导入多个时使用数组形式</p></blockquote><p><strong>繁琐的bean初始化过程处理</strong></p><ul><li>FactoryBean <ul><li>对单一的bean的初始化过程进行封装，达到简化配置的目的</li></ul></li></ul><p><strong>FactoryBean与BeanFactory的区别</strong></p><ul><li>FactoryBean：封装单个bean的创建过程</li><li>BeanFactory：Spring容器顶层接口，定义了bean相关的获取操作</li></ul><h2 id="六、aop配置" tabindex="-1"><a class="header-anchor" href="#六、aop配置" aria-hidden="true">#</a> 六、AOP配置</h2><p><strong>OOP开发思路</strong></p><figure><img src="http://images.hellocode.top/in5weF74Kc6VguU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1、简介-1" tabindex="-1"><a class="header-anchor" href="#_1、简介-1" aria-hidden="true">#</a> 1、简介</h3><ul><li>AOP（Aspect Oriented Programing）：面向切面编程，一种编程<em>范式</em>，隶属于软件工厂范畴，知道开发者如何组织程序结构</li><li>AOP弥补了OOP的不足，基于OOP基础之上进行横向开发 <ul><li>OOP规定程序开发以类为主体模型，一切围绕对象进行，完成某个任务先构建模型</li><li>AOP程序开发主要关注基于OOP开发中的共性功能，一切围绕共性功能进行，完成某个任务先构建可能遇到的所有共性功能（当所有功能都开发出来也就没有共性与非共性之分）</li></ul></li><li>“AOP联盟”：不是公司，是一个组织，提出了AOP思想</li></ul><p><strong>作用</strong></p><ul><li>伴随着AOP时代的降临，可以从各个行业的标准化、规范化开始入手，一步一步将所有共性功能逐一开发完毕，最终以功能组合来完成个别业务模块乃至整体业务系统的开发</li><li>目标：将软件开发由手工制作走向半自动化/全自动化阶段，实现“拔插式组件体系结构”搭建</li></ul><p><strong>优势</strong></p><ul><li>提高代码的可重用性</li><li>业务代码编码更简洁</li><li>业务代码维护更高效</li><li>业务功能扩展更便捷</li></ul><h3 id="_2、入门案例-1" tabindex="-1"><a class="header-anchor" href="#_2、入门案例-1" aria-hidden="true">#</a> 2、入门案例</h3><p><strong>AOP相关概念</strong></p><ul><li>Joinpoint（连接点）：就是方法</li><li><em>Pointcut（切入点）</em>：就是挖掉共性功能的方法</li><li><em>Advice（通知）</em>：就是共性功能，最终以一个方法的形式呈现</li><li>Target（目标对象）：就是挖掉功能的方法对应的类产生的对象，这种对象是是无法直接完成最终工作的</li><li>Weaving（织入）：就是将挖掉的功能回填的动态过程</li><li>Proxy（代理）：目标对象无法直接完成工作，需要对其进行功能回填，通过创建原始对象的代理对象实现</li><li>Introduction（引入/引介）：就是对原始对象无中生有的添加成员变量或成员方法</li></ul><p><strong>AOP开发过程</strong></p><ul><li>开发阶段（开发者完成） <ul><li>正常的制作程序</li><li>将非共性功能开发到对应的目标对象类中，并制作成切入点方法</li><li>将共性功能独立开发出来，制作成<em>通知</em></li><li>在配置文件中，声明<em>切入点</em></li><li>在配置文件中，声明<em>切入点</em>和<em>通知</em>间的关系（含<em>通知类型</em>），即<em>切面</em></li></ul></li><li>运行阶段（AOP完成） <ul><li>Spring容器加载配置文件，监控所有配置的<em>切入点</em>方法的执行</li><li>当监控到<em>切入点</em>方法被运行，使用<em>代理</em>机制，动态创建<em>目标对象</em>的<em>代理对象</em>，根据<em>通知类型</em>，在<em>代理对象</em>的对应位置将<em>通知</em>对应的功能<em>织入</em>，完成完整的代码逻辑并运行</li></ul></li></ul><p><strong>AOP开发方式</strong></p><ul><li>XML方式</li><li>XML+注解方式</li><li>注解方式</li></ul><p><strong>入门案例制作分析</strong></p><ol><li><p>导入相关坐标</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjweaver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>确认要抽取的功能，并将其制作成方法保存到专用的类中，删除原始业务中对应的功能</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 抽取共性功能</span>
        <span class="token comment">// System.out.println(&quot;共性功能&quot;);</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>AOPAdvice</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AOPAdvice</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;共性功能&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>将所有AOP操作的资源加载到IoC容器中</p></li><li><p>使用配置的方式描述被抽取功能的位置，并描述被抽取功能与对应位置的关系</p></li><li><p>运行程序</p></li></ol><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/aop<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/aop
            http://www.springframework.org/schema/aop/spring-aop.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--开启AOP命名空间--&gt;</span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.impl.UserServiceImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!--配置共性功能成为spring控制的bean--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.hellocode.aop.AOPAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!--配置AOP--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--配置切入点--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!--配置切面（切入点与通知的关系）--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--配置具体的切入点对应通知的哪个操作方法--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>function<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、xml配置" tabindex="-1"><a class="header-anchor" href="#_3、xml配置" aria-hidden="true">#</a> 3、XML配置</h3><p><strong>AspectJ</strong></p><ul><li>Aspect（切面）用于描述切入点与通知间的关系，是AOP编程中的一个概念</li><li>AspectJ是基于Java语言对Aspect的实现</li></ul><p><strong>AOP配置</strong></p><ul><li><p>名称：<code>aop:config</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：beans标签</p></li><li><p>作用：设置AOP</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明：一个beans标签中可以配置多个aop:config标签</p></li></ul><hr><ul><li><p>名称：<code>aop:aspect</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：<code>aop:config</code>标签</p></li><li><p>作用：设置具体的AOP通知对应的切入点</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanId<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanId<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明：一个aop:config中可以配置多个aop:aspect标签</p></li><li><p>基本属性</p><ul><li>ref：通知类所在的bean的id</li></ul></li></ul><hr><ul><li><p>名称：<code>aop:pointcut</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：<code>aop:config</code>标签、<code>aop:aspect</code>标签</p></li><li><p>作用：设置切入点</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pointcutId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>....<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pointcutId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>....<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明：一个aop:config可以配置多个aop:pointcut标签，且该标签可以配置在aop:aspect标签内</p></li><li><p>基本属性</p><ul><li>id：识别切入点的名称</li><li>expression：切入点表达式</li></ul></li></ul><p><strong>切入点表达式</strong></p><ul><li>切入点描述的是某个方法</li><li>切入点表达式是一个快速匹配方法描述的通配格式，类似于正则表达式</li></ul><p><em>语法格式</em></p><p><code>关键字 (访问修饰符 返回值 包名.类名.方法名 (参数) 异常名)</code></p><ul><li>关键字：描述表达式的匹配模式（参看关键字列表）</li><li>访问修饰符：方法的访问控制权限修饰符</li><li>类名：方法所在的类（此处可以配置接口名称）</li><li>异常：方法定义中指定抛出的异常</li><li>范例 <code>execution (public User top.hellocode.service.UserService.findById(int))</code></li></ul><blockquote><p>访问修饰符为public时可以省略</p></blockquote><p><em>关键字</em></p><table><thead><tr><th>关键字</th><th>描述</th></tr></thead><tbody><tr><td>execution【常用】</td><td>匹配执行指定方法</td></tr><tr><td>args【了解】</td><td>匹配带有指定参数类型的方法</td></tr><tr><td>within</td><td>....</td></tr><tr><td>this</td><td>....</td></tr><tr><td>target</td><td>....</td></tr><tr><td>@within</td><td>....</td></tr><tr><td>@target</td><td>....</td></tr><tr><td>@args</td><td>....</td></tr><tr><td>@annotation</td><td>....</td></tr><tr><td>bean</td><td>....</td></tr><tr><td>reference pointcut</td><td>....</td></tr></tbody></table><blockquote><p>除了前两个，后面的关键字基本不会用，需要使用的时候再查阅资料即可</p></blockquote><p><em>通配符</em></p><ul><li><p><code>*</code>：单个独立的任意符号，可以独立出现，也可以作为前缀或者后缀的匹配符出现</p><p><code>execution(public * top.hellocode.*.UserService.find*(*))</code></p><p>匹配top.hellocode包下的任意包中的UserService类或接口中所有find开头的带有一个参数的方法</p></li><li><p><code>..</code>：多个连续的任意符号，可以独立出现，常用于简化包名与参数的书写</p><p><code>execution(public User top..UserService.findById(..))</code></p><p>匹配top包下的任意包中的UserService类或接口中所有名称为findById的方法</p></li><li><p><code>+</code>：专用于匹配子类类型</p><p><code>execution(* *..*Service+.*(..))</code></p></li></ul><p><em>逻辑运算符</em></p><ul><li><code>&amp;&amp;</code>：连接两个切入点表达式，表示两个切入点表达式同时成立的匹配</li><li><code>||</code>：连接两个切入点表达式，表示两个切入点表达式成立任意一个的匹配</li><li><code>!</code>：连接单个切入点表达式，表示该切入点表达式不成立的匹配</li></ul><p><strong>三种切入点配置方式</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--配置AOP--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--公共切入点--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!--配置切面（切入点与通知的关系）--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--局部切入点--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!--配置具体的切入点对应通知的哪个操作方法--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>before<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token comment">&lt;!--直接配置切入点--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>before<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>切入点配置经验</em></p><ul><li>企业开发命名规范严格遵循规范文档进行</li><li>先为方法配置局部切入点</li><li>再抽取类中公共切入点</li><li>最后抽取全局切入点</li><li>代码走查过程中检测切入点是否存在越界性包含</li><li>代码走查过程中检测切入点是否存在非包含性进驻</li><li>设定AOP执行检测程序，在单元测试中监控通知被执行次数与预计次数是否匹配</li><li><em>设定完毕的切入点如果发生调整务必进行回归测试</em></li></ul><p>(以上规则适用于XML配置格式)</p><p><strong>五种通知类型配置</strong></p><p><em>AOP的通知类型共五种</em></p><ul><li>前置通知（<code>before</code>）：原始方法执行前执行，如果通知中抛出异常，阻止原始方法运行 <ul><li>应用：数据校验</li></ul></li><li>后置通知(<code>after</code>)：原始方法执行后执行，无论原始方法中是否出现异常，都将执行通知 <ul><li>应用：现场清理</li></ul></li><li>返回后通知(<code>after-returning</code>)：原始方法正常执行完毕后返回结果后执行，如果原始方法中抛出异常，无法执行 <ul><li>应用：返回值相关数据处理</li></ul></li><li>抛出异常后通知(<code>after-throwing</code>)：原始方法抛出异常后执行，如果原始方法没有抛出异常，无法执行 <ul><li>应用：对原始方法中出现的异常信息进行处理</li></ul></li><li>环绕通知(<code>around</code>)：在原始方法执行前后均有对应方法执行，还可以阻止原始方法的执行 <ul><li>应用：十分强大，可以做任何事情</li></ul></li></ul><hr><ul><li><p>名称：<code>aop:before</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：<code>aop:aspect</code>标签</p></li><li><p>作用：设置前置通知</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>adviceId<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>methodName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明：一个<code>aop:aspect</code>标签中可以配置多个<code>aop:before</code>标签</p></li><li><p>基本属性</p><ul><li>method：在通知类中设置当前通知类别对应的方法</li><li>pointcut：设置当前通知对应的切入点表达式，与pointcut-ref属性冲突</li><li>pointcut-ref：设置当前通知对应的切入点id，与pointcut属性冲突</li></ul></li></ul><hr><p><em>环绕通知开发方式</em></p><ul><li><p>环绕通知是在原始方法的前后添加功能，在环绕通知中，存在对原始方法的显示调用</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;around before&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 对原始方法调用</span>
    <span class="token class-name">Object</span> ret <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;around after&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>环绕通知方法相关说明</p><ul><li>方法须设定Object类型的返回值，否则会拦截原始方法的返回。如果原始方法返回值类型为void，通知方法也可以设定返回值类型为void，最终返回null</li><li>方法需在第一个参数位置设定ProceedingJoinPoint对象，通过该对象调用proceed()方法，实现对原始方法的调用。如省略该参数，原始方法将无法执行</li><li>使用proceed()方法调用原始方法时，因无法预知原始方法运行过程中是否会出现异常，强制抛出Throwable对象，封装原始方法中可能出现的异常信息</li></ul></li></ul><p><strong>通知顺序</strong>：当同一个切入点配置了多个通知时，通知会存在运行的先后顺序，该顺序以通知配置的顺序为准</p><p><strong>通知中获取参数</strong></p><ul><li><p>设定通知方法第一个参数为<code>JoinPoint</code>，通过该对象调用<code>getArgs()</code>方法，获取原始方法运行的参数数组</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> jp<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> jp<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before...&quot;</span> <span class="token operator">+</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>所有的通知均可以获取参数</p></li></ul><hr><ul><li><p>设定切入点表达式为通知方法传递参数（锁定通知变量名）</p></li><li><p>原始方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">int</span> param1<span class="token punctuation">,</span> <span class="token keyword">int</span> param2<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>AOP配置</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..)) <span class="token entity named-entity" title="&amp;">&amp;amp;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span> args(a,b) <span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>before</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>before<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通知类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;a=&quot;</span> <span class="token operator">+</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;b=&quot;</span> <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><figure><img src="http://images.hellocode.top/NgWDYkSzEaHfti4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="http://images.hellocode.top/dn8eqMtTx9U2jmC.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>通知中获取返回值</strong></p><ul><li><p>设定返回值变量名</p></li><li><p>原始方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>AOP配置</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-returning</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>afterReturning<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">returning</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ret<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通知类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterReturning</span><span class="token punctuation">(</span><span class="token class-name">Object</span> ret<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>适用于返回后通知(after-returning)</p></li></ul><hr><ul><li><p>在通知类的方法中调用原始方法获取返回值</p></li><li><p>原始方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>AOP配置</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>around</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>around<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通知类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">Object</span> ret<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Object</span> ret <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>适用于环绕通知(around)</p></li></ul><p><strong>通知中获取异常对象</strong></p><ul><li><p>设定异常对象变量名</p></li><li><p>原始方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>AOP配置</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>after-throwing</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>afterThrowing<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">throwing</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通知类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">afterThrowing</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>适用于返回后通知(after-throwing)</p></li></ul><hr><ul><li><p>在通知类的方法中调用原始方法捕获异常</p></li><li><p>原始方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;user service running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>AOP配置</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>around</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>around<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>通知类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">around</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> ret <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 对此处进行try...catch...捕获异常，或者抛出异常</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>适用于环绕通知(around)</p></li></ul><h3 id="_4、注解配置" tabindex="-1"><a class="header-anchor" href="#_4、注解配置" aria-hidden="true">#</a> 4、注解配置</h3><figure><img src="http://images.hellocode.top/9G7XQvMCwzpaAEh.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>在XML格式基础上</strong></p><ul><li>导入坐标（伴随spring-context坐标导入以及依赖导入完成）</li><li>开启AOP注解支持</li><li>配置切面<code>@Aspect</code></li><li>定义专用的切入点方法，并配置切入点<code>@Pointcut</code></li><li>为通知方法配置通知类型及对应切入点<code>@Before</code></li></ul><p><strong>注解开发AOP注意事项</strong></p><ol><li>切入点最终体现为一个方法，无参无返回值，无实际方法体内容，但不能是抽象方法</li><li>引用切入点时必须使用方法调用名称，方法后面的<code>()</code>不能省略</li><li>切面类中定义的切入点只能在当前类中使用，如果想引用其他类中定义的切入点使用“<code>类名.方法名()</code>”引用（可以专门定义一个类来存放切入点）</li><li>可以在通知类型注解后添加参数，实现XML配置中的属性，例如：after-returning后的returning属性</li></ol><p><img src="http://images.hellocode.top/LcxKmq4TVsMgZhi.png" alt="" loading="lazy"><img src="http://images.hellocode.top/JvhApbzRPagFO6T.png" alt="" loading="lazy"></p><p><strong>AOP注解开发通知执行顺序控制（了解）</strong></p><blockquote><p>AOP使用XML配置情况下，通知的执行顺序由配置顺序决定，在注解情况下由于不存在配置顺序的概念，参照通知所配置的方法名字符串对应的编码值顺序，可以简单理解为字母排序</p></blockquote><ul><li>同一个通知类中，相同通知类型以方法名排序为准</li><li>不同通知类中，以类名排序为准</li><li>使用<code>@Order</code>注解通过变更bean的加载顺序改变通知的加载顺序</li></ul><p><em>企业开发经验</em></p><ul><li>通知方法名由3部分组成，分别是前缀、顺序编码、功能描述</li><li>前缀为固定字符串，例如baidu、hellocode等，无实际意义</li><li>顺序编码为6位以内的整数，通常3位即可，不足位补0</li><li>功能描述为该方法对应的实际通知功能，例如exception、strLenCheck</li><li>控制通知执行顺序使用顺序编码控制，使用时做一定空间预留 <ul><li>003使用，006使用，预留001、002、004、005、007、008</li><li>使用时从中段开始使用，方便后期做前置追加或后置追加</li><li>最终顺序以运行顺序为准，以测试结果为准，不以设定规则为准</li></ul></li></ul><p><strong>AOP注解驱动</strong></p><ul><li><p>名称：<code>@EnableAspectJAutoProxy</code></p></li><li><p>类型：<em>注解</em></p></li><li><p>位置：Spring注解配置类定义上方</p></li><li><p>作用：设置当前类开启AOP注解驱动的支持，加载AOP注解</p></li><li><p>格式</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableAspectJAutoProxy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfig</span><span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_5、综合案例" tabindex="-1"><a class="header-anchor" href="#_5、综合案例" aria-hidden="true">#</a> 5、综合案例</h3><p>**案例介绍：**对项目进行业务层接口执行监控，测量业务层接口的执行效率</p><p><strong>案例分析</strong></p><ul><li>测量接口执行效率：接口方法执行前后获取执行时间，求出执行时长 <ul><li>System.currentTimeMillis()</li></ul></li><li>对项目进行监控：项目中所有接口方法，AOP思想，执行期动态织入代码 <ul><li>环绕通知</li><li>proceed()方法执行前后获取系统时间</li></ul></li></ul><p><strong>制作步骤</strong></p><ul><li>定义切入点（务必要绑定到接口上，而不是接口实现类上）</li><li>制作AOP环绕通知，完成测量功能</li><li>注解配置AOP</li><li>开启注解驱动支持</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月13日 15:16
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RunTimeMonitorAdvice</span> <span class="token punctuation">{</span>

    <span class="token comment">// 定义切入点，监控业务层接口</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* top.hellocode.*Service.find*(..))&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pt()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">runtimeAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span><span class="token punctuation">{</span>
        <span class="token class-name">Signature</span> signature <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> className <span class="token operator">=</span> signature<span class="token punctuation">.</span><span class="token function">getDeclaringTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 获取接口名</span>
        <span class="token class-name">String</span> methodName <span class="token operator">=</span> signature<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 获取方法名</span>

        <span class="token keyword">long</span> sum <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> ret <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">// 为了增强精确度，使用循环</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>pjp<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sum <span class="token operator">+=</span> endTime <span class="token operator">-</span> startTime<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>className <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> methodName <span class="token operator">+</span> <span class="token string">&quot;(万次)run:&quot;</span> <span class="token operator">+</span> sum <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>案例后续思考与设计</strong></p><p><em>测量真实性</em></p><ul><li>开发测量是隔离性反复执行某个操作，是理想情况，上线测量差异过大</li><li>上线测量服务器性能略低于单机开发测量</li><li>上线测量基于缓存的性能查询要优于数据库查询测量</li><li>上线测量接口的性能与最终对外提供的服务性能差异过大</li><li>当外部条件发生变化（硬件），需要进行回归测试，例如数据库迁移</li></ul><p><em>测量结果展示</em></p><ul><li>测量结果无需每一个都展示，需要设定检测阈值</li><li>阈值设定要根据业务进行区分，一个复杂的查询与简单的查询差异化很大</li><li>阈值设定需要做独立的配置文件或通过图形工具配置（工具级别的开发）</li><li>配合图形界面展示测量结果</li></ul><h2 id="七、aop底层原理" tabindex="-1"><a class="header-anchor" href="#七、aop底层原理" aria-hidden="true">#</a> 七、AOP底层原理</h2><h3 id="_1、静态代理" tabindex="-1"><a class="header-anchor" href="#_1、静态代理" aria-hidden="true">#</a> 1、静态代理</h3><blockquote><p>装饰者模式（Decorator Pattern）：在不惊动原始设计的基础上，为其添加功能</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">base<span class="token punctuation">.</span>decorator</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">top<span class="token punctuation">.</span>hellocode<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月13日 18:05
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImplDecorator</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UserServiceImplDecorator</span><span class="token punctuation">(</span><span class="token class-name">UserService</span> userService<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userService <span class="token operator">=</span> userService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 增强功能</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;刮大白&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">UserService</span> userService1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserServiceImplDecorator</span><span class="token punctuation">(</span>userService<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userService1<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 此处增强了功能</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、jdkproxy动态代理" tabindex="-1"><a class="header-anchor" href="#_2、jdkproxy动态代理" aria-hidden="true">#</a> 2、JDKProxy动态代理</h3><blockquote><p>JDKProxy动态代理是针对对象做代理，要求原始对象具有接口实现，并对接口方法进行增强</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">base<span class="token punctuation">.</span>proxy</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">top<span class="token punctuation">.</span>hellocode<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Proxy</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月13日 18:11
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceJDKProxy</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">UserService</span> <span class="token function">createUserServiceJDKProxy</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ClassLoader</span> cl <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> classes <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InvocationHandler</span> ih <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token class-name">Object</span> ret <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>userService<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;刮大白&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">UserService</span> service <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>cl<span class="token punctuation">,</span>classes<span class="token punctuation">,</span>ih<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> service<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">UserService</span> userService1 <span class="token operator">=</span> <span class="token class-name">UserServiceJDKProxy</span><span class="token punctuation">.</span><span class="token function">createUserServiceJDKProxy</span><span class="token punctuation">(</span>userService<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userService1<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、cglib动态代理" tabindex="-1"><a class="header-anchor" href="#_3、cglib动态代理" aria-hidden="true">#</a> 3、Cglib动态代理</h3><ul><li>CGLIB(Code Generation Library),Code生成类库</li><li>CGLIB动态代理不限定是否具有接口，可以对任意操作进行增强</li><li>CGLIB动态代理无需要原始被代理对象，动态创建出新的代理对象<img src="http://images.hellocode.top/QkcfRzM6uqSZ9pj.png" alt="" loading="lazy"></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">base<span class="token punctuation">.</span>cglib</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span><span class="token class-name">Enhancer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span><span class="token class-name">MethodInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span></span><span class="token class-name">MethodProxy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">top<span class="token punctuation">.</span>hellocode<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月13日 18:30
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceCglibProxy</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">UserService</span> <span class="token function">createUserServiceCglibProxy</span><span class="token punctuation">(</span><span class="token class-name">Class</span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Enhancer</span> enhancer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 创建动态字节码</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        enhancer<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MethodInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objects<span class="token punctuation">,</span> <span class="token class-name">MethodProxy</span> methodProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token class-name">Object</span> ret <span class="token operator">=</span> methodProxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> objects<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 调用原始方法</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;save&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;刮大白&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 对原始方法做增强</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> enhancer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token class-name">UserServiceCglibProxy</span><span class="token punctuation">.</span><span class="token function">createUserServiceCglibProxy</span><span class="token punctuation">(</span><span class="token class-name">UserServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>代理模式的选择</strong></p><blockquote><p>Spring可以通过配置的形式控制使用的代理形式，默认使用JDKProxy，通过配置可以修改为使用CGLib</p></blockquote><p><em>XML配置</em></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span> <span class="token attr-name">proxy-target-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><em>XML注解支持</em></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspectj-autoproxy</span> <span class="token attr-name">proxy-target-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em>注解驱动</em></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableAspectJAutoProxy</span><span class="token punctuation">(</span>proxyTargetClass <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>false（默认）：JDKProxy；</p><p>true：CGLibProxy</p></blockquote><h3 id="_4、织入时机" tabindex="-1"><a class="header-anchor" href="#_4、织入时机" aria-hidden="true">#</a> 4、织入时机</h3><figure><img src="http://images.hellocode.top/CjJtw56b8E9OmrN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>Spring使用的是运行期织入</p></blockquote><h2 id="八、事务管理" tabindex="-1"><a class="header-anchor" href="#八、事务管理" aria-hidden="true">#</a> 八、事务管理</h2><h3 id="_1、基础概念" tabindex="-1"><a class="header-anchor" href="#_1、基础概念" aria-hidden="true">#</a> 1、基础概念</h3><ul><li>事务指数据库中个别操作失败时，提供一种方式使数据库恢复到正常状态（A），保障数据库即使在异常状态下仍能保持数据一致性（C）（要么操作前状态，要么操作后状态）</li><li>当出现并发访问时，在多个访问间进行相互隔离，防止并发访问操作结果互相干扰（I）</li></ul><p><strong>事务特征（ACID）</strong></p><ul><li>原子性（Atomicity）：指事务是一个不可分割的整体，其中的操作要么全执行或全不执行</li><li>一致性（Consistency）：事务前后数据的完整性必须保持一致</li><li>隔离性（Isolation）：事务的隔离性是多个用户并发访问数据库时，数据库为每一个用户开启的事务，不能被其他事务的操作数据所干扰，多个并发事务之间要互相隔离</li><li>持久性（Durability）：持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响</li></ul><p><strong>事务隔离级</strong></p><p><em>脏读</em>：允许读取未提交的信息</p><ul><li>原因：Read uncommitted</li><li>解决方案：Read Committed（表级读锁）</li></ul><p><em>不可重复读</em>：读取过程中单个数据发生了变化</p><ul><li>解决方案：Repeatable read（行级写锁）</li></ul><p><em>幻读</em>：读取过程中数据条目发生了变化</p><ul><li>解决方案：Serializable（表级写锁）</li></ul><h3 id="_2、spring核心事务对象" tabindex="-1"><a class="header-anchor" href="#_2、spring核心事务对象" aria-hidden="true">#</a> 2、Spring核心事务对象</h3><blockquote><p>J2EE开发使用分层设计的思想进行，对于简单的业务层转调数据层的单一操作，事务开启在业务层或者数据层并无太大差别，当业务中包含多个数据层的调用时，需要在业务层开启事务，对数据层中多个操作进行组合并归属于同一个事务进行处理</p></blockquote><p>Spring为业务层提供了整套的事务解决方案</p><ul><li>PlatformTransactionManager</li><li>TransactionDefinition</li><li>TransactionStatus</li></ul><p><strong>PlatformTransactionManager</strong>（平台事务管理器实现类）</p><ul><li><em>DataSourceTransactionManager</em>：适用于Spring JDBC或Mybatis</li><li>HibernateTransactionManager：适用于Hibernate3.0及以上版本</li><li>JpaTransactionManager：适用于JPA</li><li>JdoTransactionManager：适用于JDO</li><li>JtaTransactionManager：适用于JTA</li></ul><hr><ul><li>JPA(Java Persistence API)：Java EE标准之一，为POJO提供持久化标准规范，并规范了持久化开发的统一API，符合JPA规范的开发可以在不同的JPA框架下运行</li><li>JDO(Java Data Object)：是Java对象持久化规范，用于存取某数据库中的对象，并提供规范化API。与JDBC相比，JDBC仅针对关系型数据库进行操作，JDO可以扩展到关系型数据库、文件、XML、对象数据库（ODBMS）等，可移植性更强</li><li>JTA(Java Transaction API)：Java EE标准之一，允许应用程序执行分布式事务处理。与JDBC相比，JDBC事务则被限定在一个单一的数据库连接，而一个JTA事务可以有多个参与者，比如JDBC连接、JDO都可以参与到一个JTA事务中</li></ul><hr><blockquote><p>PlatformTransactionManager接口定义了事务的基本操作</p></blockquote><ul><li><p>获取事务</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">TransactionStatus</span> <span class="token function">getTransaction</span><span class="token punctuation">(</span><span class="token class-name">TransactionDefinition</span> definition<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>提交事务</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token class-name">TransactionStatus</span> status<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>回滚事务</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token class-name">TransactionStatus</span> status<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p><strong>TransactionDefinition</strong></p><blockquote><p>此接口定义了事务的基本信息</p></blockquote><ul><li><p>获取事务定义名称</p><p><code>String getName()</code></p></li><li><p>获取事务的读写属性</p></li></ul><p><code>boolean isReadOnly()</code></p><ul><li>获取事务隔离级别</li></ul><p><code>int getIsolationLevel()</code></p><ul><li>获取事务超时时间</li></ul><p><code>int getTimeout()</code></p><ul><li><p>获取事务传播行为特征</p><p><code>int getPropagationBehavior()</code></p></li></ul><p><strong>TransactionStatus</strong></p><blockquote><p>此接口定义了事务在执行过程中某个时间点上的状态信息及对应的状态操作</p></blockquote><ul><li>获取事务是否处于新开启事务状态：<code>boolean isNewTransaction()</code></li><li>获取事务是否处于已完成状态：<code>boolean isCompleted()</code></li><li>获取事务是否处于回滚状态：<code>boolean isRollbackOnly()</code></li><li>刷新事务状态：<code>void flush()</code></li><li>获取事务是否具有回滚存储点：<code>boolean hasSavepoint()</code></li><li>设置事务处于回滚状态：<code>void setRollbackOnly()</code></li></ul><h3 id="_3、案例介绍" tabindex="-1"><a class="header-anchor" href="#_3、案例介绍" aria-hidden="true">#</a> 3、案例介绍</h3><p><strong>基于Spring、Mybatis整合</strong></p><ul><li>银行转账业务说明</li></ul><p>银行转账操作中，涉及从A账户到B账户的资金转移操作。数据层仅提供单条数据的基础操作，未设计多账户间的业务操作</p><ul><li><p>业务层接口提供转账操作</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">top<span class="token punctuation">.</span>hellocode<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月14日 17:34
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">String</span> outName<span class="token punctuation">,</span> <span class="token class-name">String</span> inName<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>业务层实现提供转账操作</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">String</span> outName<span class="token punctuation">,</span> <span class="token class-name">String</span> inName<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    accountDao<span class="token punctuation">.</span><span class="token function">inMoney</span><span class="token punctuation">(</span>outName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
    accountDao<span class="token punctuation">.</span><span class="token function">outMoney</span><span class="token punctuation">(</span>inName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>数据层提供对应的入账与出账操作</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">&lt;</span>mapper namespace<span class="token operator">=</span><span class="token string">&quot;top.hellocode.dao.AccountDao&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>update id<span class="token operator">=</span><span class="token string">&quot;inMoney&quot;</span><span class="token operator">&gt;</span>
        update account set money <span class="token operator">=</span> money <span class="token operator">+</span> #<span class="token punctuation">{</span>money<span class="token punctuation">}</span> where name <span class="token operator">=</span> #<span class="token punctuation">{</span>name<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>update<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>update id<span class="token operator">=</span><span class="token string">&quot;outMoney&quot;</span><span class="token operator">&gt;</span>
        update account set money <span class="token operator">=</span> money <span class="token operator">-</span> #<span class="token punctuation">{</span>money<span class="token punctuation">}</span> where name <span class="token operator">=</span> #<span class="token punctuation">{</span>name<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>update<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>mapper<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_4、编程式事务" tabindex="-1"><a class="header-anchor" href="#_4、编程式事务" aria-hidden="true">#</a> 4、编程式事务</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月14日 17:33
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAccountDao</span><span class="token punctuation">(</span><span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>accountDao <span class="token operator">=</span> accountDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">String</span> outName<span class="token punctuation">,</span> <span class="token class-name">String</span> inName<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创造事务管理器</span>
        <span class="token class-name">PlatformTransactionManager</span> ptm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceTransactionManager</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建事务定义对象</span>
        <span class="token class-name">TransactionDefinition</span> td <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultTransactionDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建事务状态对象，用于控制事务执行</span>
        <span class="token class-name">TransactionStatus</span> ts <span class="token operator">=</span> ptm<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span>td<span class="token punctuation">)</span><span class="token punctuation">;</span>

        accountDao<span class="token punctuation">.</span><span class="token function">inMoney</span><span class="token punctuation">(</span>outName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">// 模拟错误</span>
        accountDao<span class="token punctuation">.</span><span class="token function">outMoney</span><span class="token punctuation">(</span>inName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 提交事务</span>
        ptm<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>AOP改造编程式事务</strong></p><blockquote><p>将业务层的事务处理功能抽取出来制作成AOP通知，利用环绕通知运行期的动态织入</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月14日 17:33
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAccountDao</span><span class="token punctuation">(</span><span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>accountDao <span class="token operator">=</span> accountDao<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">String</span> outName<span class="token punctuation">,</span> <span class="token class-name">String</span> inName<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        accountDao<span class="token punctuation">.</span><span class="token function">inMoney</span><span class="token punctuation">(</span>outName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
        accountDao<span class="token punctuation">.</span><span class="token function">outMoney</span><span class="token punctuation">(</span>inName<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> HelloCode
 * <span class="token keyword">@site</span> https://www.hellocode.top
 * <span class="token keyword">@date</span> 2022年07月14日 18:53
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TxAdvice</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">transactionManager</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> pjp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token comment">// 开启事务</span>
        <span class="token class-name">PlatformTransactionManager</span> ptm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceTransactionManager</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 事务定义对象</span>
        <span class="token class-name">TransactionDefinition</span> td <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultTransactionDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 事务状态对象</span>
        <span class="token class-name">TransactionStatus</span> ts <span class="token operator">=</span> ptm<span class="token punctuation">.</span><span class="token function">getTransaction</span><span class="token punctuation">(</span>td<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> ret <span class="token operator">=</span> pjp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>pjp<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 提交事务</span>
        ptm<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* *..transfer(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>aspect</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txAdvice<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>around</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>transactionManager<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>aspect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5、声明式事务" tabindex="-1"><a class="header-anchor" href="#_5、声明式事务" aria-hidden="true">#</a> 5、声明式事务</h3><h4 id="_5-1-配置文件" tabindex="-1"><a class="header-anchor" href="#_5-1-配置文件" aria-hidden="true">#</a> 5.1. 配置文件</h4><ul><li><p>开启tx命名空间</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
http://www.springframework.org/schema/tx
http://www.springframework.org/schema/tx/spring-tx.xsd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用tx命名空间配置事务专属通知类</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txManager<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource.DataSourceTransactionManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--定义事务管理的通知类--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>advice</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txAdvice<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--定义控制的事务--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>method</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">read-only</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>method</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">read-only</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>advice</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用aop:advisor在AOP配置中引用事务专属通知类</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>pointcut</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span> <span class="token attr-name">expression</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>execution(* top.hellocode.service.*Service.*(..))<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">aop:</span>advisor</span> <span class="token attr-name">advice-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txAdvice<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pointcut-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">aop:</span>config</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>aop:advice与aop:advisor的区别</strong></p><ul><li><code>aop:advice</code>：配置的通知类可以是普通的Java对象，不实现接口，也不使用继承关系</li><li><code>aop:advisor</code>：配置的通知类必须实现通知接口 <ul><li>MethodBeforeAdvice</li><li>AfterReturningAdvice</li><li>ThrowsAdvice</li><li>......</li></ul></li></ul><hr><p><strong>tx配置</strong></p><ul><li><p>名称：<code>tx:advice</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：beans标签</p></li><li><p>作用：专用于声明事务通知</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>advice</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txAdvice<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>advice</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>基本属性</p><ul><li>id：用于配置aop时指定通知器的id</li><li>transaction-manager：指定事务管理器bean</li></ul></li></ul><hr><ul><li><p>名称：<code>tx:attributes</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：<code>tx:advice</code>标签</p></li><li><p>作用：定义通知属性</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>advice</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txAdvice<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>advice</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>基本属性</p><ul><li>无</li></ul></li></ul><hr><ul><li><p>名称：<code>tx:method</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：<code>tx:attribute</code>标签</p></li><li><p>作用：设置具体的事务属性</p></li><li><p>格式</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>method</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">read-only</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>method</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">read-only</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">tx:</span>attributes</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>说明：通常事务属性会配置多个，包含1个读写的全事务属性，1个只读的查询类事务属性</p></li></ul><p><strong>tx:method属性</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>method</span>
    <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span>			<span class="token attr-name">待添加事务的方法名表达式（支持*号通配符），例如get*、*、....</span>
    <span class="token attr-name">read-only</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>		<span class="token attr-name">设置事务的读写属性，true为只读，false为读写</span>
    <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span>		<span class="token attr-name">设置事务的超时时长，单位秒</span>
    <span class="token attr-name">isolation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEFAULT<span class="token punctuation">&quot;</span></span>		<span class="token attr-name">设置事务隔离级别，该隔离级设定是基于Spring的设定，非数据库端</span>
    <span class="token attr-name">no-rollback-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>		<span class="token attr-name">设置事务中不回滚的异常，多个异常间使用,分割</span>
    <span class="token attr-name">rollback-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>			<span class="token attr-name">设置事务中必回滚的异常，多个异常间使用,分割</span>
    <span class="token attr-name">propagation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>REQUIRED<span class="token punctuation">&quot;</span></span>		<span class="token attr-name">设置事务的传播行为</span>
    <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-2-事务传播行为" tabindex="-1"><a class="header-anchor" href="#_5-2-事务传播行为" aria-hidden="true">#</a> 5.2. 事务传播行为</h4><ul><li>事务管理员</li><li>事务协调员</li></ul><figure><img src="http://images.hellocode.top/KkrzXBANPFDQLig.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>事务传播行为描述的是事务协调员对事务管理员所携带事务的处理态度</li></ul><figure><img src="http://images.hellocode.top/3vilr2seS4cQH5J.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>REQUIRED</code>：如果事务管理员开启了一个事务，那么如果事务协调员就会加入这个事务，所以他们两个都是用同一个事务都是T1；如果事务管理员没有开事务，那么事务协调员就会直接新建一个事务</li></ul><figure><img src="http://images.hellocode.top/A6VoBywmfvJYa5p.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>REQUIRES_NEW</code>：事务管理员不管开启还是没有开启一个事务，事务协调员都会再新建一个事务</li></ul><figure><img src="http://images.hellocode.top/mH2AF9PagwJuR1k.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>SUPPORTS</code>：如果事务管理员原来有事务，那么事务协调员就会加入这个事务；如果事务管理员原来没有事务，那么事务协调员不会加入，不要事务了</li></ul><figure><img src="http://images.hellocode.top/a8VhZzjPuOFKbWq.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>NOT_SUPPORTED</code>：原来事务管理员来的时候有没有事务，事务协调员都不会有事务</li></ul><figure><img src="http://images.hellocode.top/yGUTkvjLX3HZDqF.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>MANDATORY</code>：必须有事务，事务管理员来的时候带的有事务，事务协调员就会加入这个事务，如果事务管理员来的时候没有事务，那么就会报错</li></ul><figure><img src="http://images.hellocode.top/ZAzxDCu4QGneYvJ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><code>NEVER</code>：不需要带的有事务，事务管理员来的时候如果带了事务，就会出现错误；如果不带事务的话，事务协调员也不会有事务</li></ul><figure><img src="http://images.hellocode.top/ec4jwXSU9H3gYZ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><em>事务传播应用</em></p><p>场景A：生成订单业务</p><ul><li>子业务S1：记录日志到数据库表X</li><li>子业务S2：保存订单数据到数据库表Y</li><li>子业务S3：......</li><li>如果S2或S3或...事务提交失败，此时S1是否回滚？如何控制？</li><li>（S1需要新事务）</li></ul><p>场景B：生成订单业务</p><ul><li>背景1：订单号生成依赖数据库中一个专门用于控制订单号编号生成的表M获取</li><li>背景2：每次获取完订单号，表M中记录的编号自增1</li><li>子业务S1：从表M中获取订单编号</li><li>子业务S2：保存订单数据，订单编号来自于表M</li><li>子业务S3：......</li><li>（S1需要新事务）</li></ul><h4 id="_5-3-注解方式" tabindex="-1"><a class="header-anchor" href="#_5-3-注解方式" aria-hidden="true">#</a> 5.3. 注解方式</h4><ul><li><p>名称：<code>@Transactional</code></p></li><li><p>类型：<em>方法注解</em>、<em>类注解</em>、<em>接口注解</em>(主流)</p></li><li><p>位置：方法定义上方，类定义上方，接口定义上方</p></li><li><p>作用：设置当前类/接口中所有的方法或具体方法开启事务，并指定相关事务属性</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">{</span>
    readOnly <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    timeout <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    isolation <span class="token operator">=</span> <span class="token class-name">Isolation</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">,</span>
    rollbackFor <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">ArithmeticException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    noRollbackFor <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    propagation <span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span><span class="token constant">REQUIRES_NEW</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><ul><li><p>名称：<code>tx:annotation-driven</code></p></li><li><p>类型：<em>标签</em></p></li><li><p>归属：beans标签</p></li><li><p>作用：开启事务注解驱动，并指定对应的事务管理器</p></li><li><p>范例</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>annotation-driven</span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>txManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p><strong>注解驱动</strong></p><ul><li><p>名称：<code>@EnableTransactionManagement</code></p></li><li><p>类型：<em>类注解</em></p></li><li><p>位置：Spring注解配置类上方</p></li><li><p>作用：开启注解驱动，等同XML格式中的注解驱动</p></li><li><p>范例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;top.hellocode&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConfig</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransactionManagerConfig</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">PlatformTransactionManager</span> <span class="token function">getTransactionManager</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Autowired</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceTransactionManager</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="九、模板对象" tabindex="-1"><a class="header-anchor" href="#九、模板对象" aria-hidden="true">#</a> 九、模板对象</h2><ul><li>TransactionTemplate</li><li>JDBCTemplate</li><li>RedisTemplate</li><li>RabbitTemplate</li><li>JmsTemplate</li><li>HibernateTemplate</li><li>RestTemplate</li></ul><h3 id="_1、jdbctemplate" tabindex="-1"><a class="header-anchor" href="#_1、jdbctemplate" aria-hidden="true">#</a> 1、JdbcTemplate</h3><blockquote><p>了解学习即可</p></blockquote><ul><li><p>提供标准的sql语句操作API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into account(name,money) values(?,?)&quot;</span><span class="token punctuation">;</span>
    jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>account<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>account<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>NamedParameterJdbcTemplate(了解)</strong></p><ul><li><p>提供标准的具名sql语句操作API</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into account(name,money) values(:name,:money)&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span> pm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pm<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>account<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pm<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;money&quot;</span><span class="token punctuation">,</span>account<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>pm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_2、redistemplate" tabindex="-1"><a class="header-anchor" href="#_2、redistemplate" aria-hidden="true">#</a> 2、RedisTemplate</h3><ul><li>RedisTemplate对象结构</li></ul><figure><img src="http://images.hellocode.top/l9P1JFe4Ldp5XbQ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">changeMoney</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;account:id:&quot;</span><span class="token operator">+</span>id<span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">Double</span> <span class="token function">findMondyById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> money <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;account:id:&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>money<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、设计模式" tabindex="-1"><a class="header-anchor" href="#_3、设计模式" aria-hidden="true">#</a> 3、设计模式</h3><p><strong>策略模式</strong></p><ul><li>策略模式（Strategy Pattern）：使用不同策略的对象实现不同的行为方式，策略对象的变化导致行为的变化</li></ul><figure><img src="http://images.hellocode.top/vsG7PQzKkw6VbBU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="http://images.hellocode.top/20210629105229403.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>装饰模式</strong></p><ul><li>JdbcTemplate</li><li>NamedParameterJdbcTemplate</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/HelloCode66/Java-Navigation/edit/main/src/md/spring/framework.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><!----></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 10837907@qq.com">HelloCode</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/java-navigation/md/spring/outline.html" class="nav-link prev" aria-label="大纲"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->大纲</div></a><a href="/java-navigation/md/spring/mvc.html" class="nav-link next" aria-label="SpringMVC"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">SpringMVC<!----></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">默认页脚</div><div class="copyright">Copyright © 2022 HelloCode.</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/java-navigation/assets/app.a902b09b.js" defer></script>
  </body>
</html>
